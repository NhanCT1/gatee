var kaktuspbaseUrl="https://po.kaktusapp.com/";var kaktuspApiUrl="https://po.kaktusapp.com/";var kaktuspShop="gate-enterprise-usd.myshopify.com";var kaktuspTriggerProducts={"all_products":false,"products":[]};var kaktuspTriggerEvents=[6];var kaktuspCurrencyCode="USD";var kaktuspCurrencySymbol="USD {{amount}}";var kaktuspVersion="142"
var kaktuspInlineWidget="";var kaktuspRemoveButtonSelector="";var kaktuspQuantitySelector="";var kaktuspFreeActiveApp=1;if(!kaktuspApp){var kaktuspApp=function(){const noImage=kaktuspbaseUrl+'assets/images/no-image.jpg';let currentProductId;let purchaseData=[];let orderData=[];let statisticArr=[];let iframe;let productsData=[];let excludeOffers=[];let triggerProduct=false;let volumeOffer=null;let facebookId=null;let googleId=null;let pinterestId=null;let snapId=null;let snapEmail=null;let sliderAutoplay;const sliderDelay=5000;const offerTypes={crossSell:1,upsell:2,bundle:3,postPurchase:4,discount:5,frequentlyBoughtTogether:6,homePage:8,exitIntent:7,cartPage:9,beforeCheckout:10,slider:11,bundleByProduct:13,bundleComboProducts:14,bundleBuilder:15,fbt:16,volumeDiscount:17}
const triggerTypes={addToCart:'1',cartPage:'2',thankYouPage:'3',selectedPages:'4',certainButtons:'5',productPage:'6',exitIntent:'7',homePage:'8',collectionPage:'9',blogPage:'10',beforeCheckout:'11',buyItNow:'12'}
const popupTypes={popup:'1',float_popup:'2',inline:'3'}
const inlineWidgetPosition={before:'1',after:'2'}
kaktuspCurrencySymbol=decodeHTML(kaktuspCurrencySymbol.replace(/(<([^>]+)>)/ig,""));const currentCurrencyCode=Shopify.currency.active;let currentCurrencySymbol=kaktuspCurrencySymbol;let currencyRate=1;if(kaktuspCurrencyCode!==currentCurrencyCode){const country=Shopify.country;currencyRate=Shopify.currency.rate;const regexStr=`[${getMainCurrencySymbol()}]`;const regex=new RegExp(regexStr,'g')
currentCurrencySymbol=kaktuspCurrencySymbol.replace(regex,getCurrencySymbol(country,currentCurrencyCode));}
function getCurrencySymbol(locale,currency){return(0).toLocaleString(locale.toLowerCase(),{style:'currency',currency:currency,minimumFractionDigits:0,maximumFractionDigits:0}).replace(/\d/g,'').trim()}
function getMainCurrencySymbol(){if(kaktuspCurrencySymbol.includes('{{')){return kaktuspCurrencySymbol.replace(/{{(.*?)}}/ig,'').trim();}else{return kaktuspCurrencySymbol.trim();}}
function getPriceByRate(price){return(parseFloat(price)*currencyRate).toFixed(2);}
function getStorePriceByRate(price){return(parseFloat(price)/ currencyRate).toFixed(2);}
function currencyFormat(num){if(currentCurrencySymbol.includes('{{')){return currentCurrencySymbol.replace(/{{(.*?)}}/ig,formatNumber(num));}else{return currentCurrencySymbol+formatNumber(num);}}
function formatNumber(num){num=parseFloat(num).toFixed(2);return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");}
function decodeHTML(html){const txt=document.createElement('textarea');txt.innerHTML=html;return txt.value;};let slideUp=(target,duration=500)=>{target.style.transitionProperty='height, margin, padding';target.style.transitionDuration=duration+'ms';target.style.boxSizing='border-box';target.style.height=target.offsetHeight+'px';target.offsetHeight;target.style.overflow='hidden';target.style.height=0;target.style.paddingTop=0;target.style.paddingBottom=0;target.style.marginTop=0;target.style.marginBottom=0;window.setTimeout(()=>{target.style.display='none';target.style.removeProperty('height');target.style.removeProperty('padding-top');target.style.removeProperty('padding-bottom');target.style.removeProperty('margin-top');target.style.removeProperty('margin-bottom');target.style.removeProperty('overflow');target.style.removeProperty('transition-duration');target.style.removeProperty('transition-property');},duration);}
let slideDown=(target,duration=500)=>{target.style.removeProperty('display');let display=window.getComputedStyle(target).display;if(display==='none')display='flex';target.style.display=display;let height=target.offsetHeight;target.style.overflow='hidden';target.style.height=0;target.style.paddingTop=0;target.style.paddingBottom=0;target.style.marginTop=0;target.style.marginBottom=0;target.offsetHeight;target.style.boxSizing='border-box';target.style.transitionProperty="height, margin, padding";target.style.transitionDuration=duration+'ms';target.style.height=height+'px';target.style.removeProperty('padding-top');target.style.removeProperty('padding-bottom');target.style.removeProperty('margin-top');target.style.removeProperty('margin-bottom');window.setTimeout(()=>{target.style.removeProperty('height');target.style.removeProperty('overflow');target.style.removeProperty('transition-duration');target.style.removeProperty('transition-property');},duration);}
function setCookieData(){let url=location.href;const kaktuspCurrentShownPerMonth=getCookie('kaktuspCurrentShownPerMonth');const kaktuspCurrentShownPerDay=getCookie('kaktuspCurrentShownPerDay');const ZERO=0;const oneMonth=new Date(Date.now()+3600000*24*25);const oneWeek=new Date(Date.now()+3600000*24*7);const oneDay=new Date(Date.now()+3600000*24);let currentDate=new Date(Date.now());currentDate=currentDate.toUTCString();if(url.includes('#')){url=url.split('#');if(url[url.length-1]){let parameter='#'+url[url.length-1];setCookie('kaktuspUrl',parameter,{expires:oneWeek});}}
if(!kaktuspCurrentShownPerMonth){setCookie('kaktuspCurrentShownPerMonth',ZERO,{expires:oneMonth});setCookie('kaktuspStartDatePerMonth',currentDate,{expires:oneMonth});}
if(!kaktuspCurrentShownPerDay){setCookie('kaktuspCurrentShownPerDay',ZERO,{expires:oneDay});setCookie('kaktuspStartDatePerDay',currentDate,{expires:oneDay});}}
setCookieData();function setCookie(name,value,options={}){options={path:'/',...options};if(options.expires instanceof Date){options.expires=options.expires.toUTCString();}
let updatedCookie=encodeURIComponent(name)+"="+encodeURIComponent(value);for(let optionKey in options){updatedCookie+="; "+optionKey;let optionValue=options[optionKey];if(optionValue!==true){updatedCookie+="="+optionValue;}}
document.cookie=updatedCookie;}
function getCookie(name){let matches=document.cookie.match(new RegExp("(?:^|; )"+name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,'\\$1')+"=([^;]*)"));return matches?decodeURIComponent(matches[1]):undefined;}
function setContainerId(){return`kaktusp-app-${makeId(5)}`;}
function buildPopUpType(dataOffer,dataCart,currentProductId,triggerType){const offerItem=Object.values(dataOffer.offers)[0];const popUpType=(offerItem.popup_type).toString();switch(popUpType){case popupTypes.popup:buildPopUp({dataOffer,offerItem,dataCart,currentProductId,triggerType});break;case popupTypes.float_popup:buildMiniPopUp({dataOffer,offerItem,dataCart,currentProductId,triggerType});break;case popupTypes.inline:buildInlineWidget({dataOffer,offerItem,dataCart,currentProductId,triggerType});break;}
socialPixel();}
function buildInlineWidget(params){const{offerItem,triggerType}=params;let rootId=setContainerId();let nodeElement=null;nodeElement=getInlineNode(triggerType);function getInlineNode(triggerType){let defaultNodeElements=[];let inlineWidgetArr=[];switch(triggerType){case triggerTypes.productPage:defaultNodeElements=['.product-form','kaktuspInlineWidget'];inlineWidgetArr=kaktuspInlineWidget.length?decodeHTML(kaktuspInlineWidget).split(','):inlineWidgetArr;break;}
const commonInlineWidgetArr=inlineWidgetArr.concat(defaultNodeElements);const uniqueInlineWidgetArr=[...new Set(commonInlineWidgetArr)];if(uniqueInlineWidgetArr.length){for(let i=0;i<uniqueInlineWidgetArr.length;i++){const itemTrim=uniqueInlineWidgetArr[i].trim();const currentNode=document.querySelector(itemTrim);if(currentNode!=null){return currentNode;}}}else{return null;}}
if(!nodeElement)return;const isSylesheet=document.querySelector('link[title=KaktusPreOrder]');if(!isSylesheet){styleLoader();}
buildInlineContainer();function styleLoader(){const headID=document.getElementsByTagName('head')[0];const link=document.createElement('link');link.type='text/css';link.title='KaktusPreOrder';link.rel='stylesheet';headID.appendChild(link);link.href=kaktuspbaseUrl+`css/kaktus-pre-order.css?v=${kaktuspVersion}`;};function buildInlineContainer(){const insertPosition=(offerItem.inline_position).toString();const element=document.createElement("div");element.setAttribute("id",rootId);element.style.width='100%';element.style.margin='20px 0';element.style.fontFamily='inherit';element.style.display='none';if(insertPosition===inlineWidgetPosition.before){nodeElement.before(element);}else{nodeElement.after(element);}}
const offerType=offerItem.offer_type;switch(offerType){case offerTypes.volumeDiscount:buildPreOrderInline({rootId,...params});break;}}
function buildPopUp(params){const{offerItem}=params;if(!popupShow)return;let rootId=setContainerId();increasePopupShown();disabledPageScroll();let kaktuspPopup=document.querySelector(`#${rootId}`);if(kaktuspPopup){kaktuspPopup.remove();}
const offerType=offerItem.offer_type;buildIframe(rootId);}
function buildIframe(rootId){const html=`<iframe id="kaktusp-widget" style="width: 100% !important; height: 100% !important" frameborder="0" srcdoc='<!DOCTYPE html><html><head><link type="text/css" rel="stylesheet" href="${kaktuspbaseUrl}css/kaktus-pre-order.css?v=${kaktuspVersion}"></head><body><div id="${rootId}"></div></body></html>'></iframe>`;const element=document.createElement("div");element.setAttribute("id",rootId);element.innerHTML=html;element.style.height='100%';element.style.width='100%';element.style.position='fixed';element.style.top='0';element.style.left='0';element.style.zIndex='99999999999999999';document.querySelector('body').append(element);}
function disabledPageScroll(){document.querySelector('body').style.overflow='hidden';document.querySelector('body').style.height='100%';document.querySelector('html').style.overflow='hidden';document.querySelector('html').style.height='100%';}
function removeAppContainer(rootId){clearInterval(sliderAutoplay);const kaktuspPopup=document.querySelector(`#${rootId}`);iframe=null;if(kaktuspPopup){kaktuspPopup.remove();}
document.querySelector('body').style.overflow='';document.querySelector('body').style.height='';document.querySelector('html').style.overflow='';document.querySelector('html').style.height='';}
function getAppSelector(element,rootId){let rootNode=document.querySelector(`#${rootId}`);if(iframe){rootNode=iframe.contentWindow.document.querySelector(`#${rootId}`);}
return rootNode.querySelector(element);}
function getAppSelectorAll(element,rootId){let rootNode=document.querySelector(`#${rootId}`);if(iframe){rootNode=iframe.contentWindow.document.querySelector(`#${rootId}`);}
return rootNode.querySelectorAll(element);}
function buildPreOrderInline(params){const{dataOffer,offerItem,currentProductId,rootId,triggerType}=params;const offerObj={mainOfferId:offerItem.main_offer_id,offerId:offerItem.id,allow_set_quantities:offerItem.allow_set_quantities,allow_title:offerItem.allow_title,offerDesign:dataOffer.design[offerItem.id],allowPageReload:offerItem.reload_page?true:false,pageReload:false,currentTriggerType:triggerType,volumeId:makeId(5)}
const offerTexts={'allow_title':offerItem.allow_title,'title':offerItem.title,'allow_set_description':offerItem.allow_set_description,'description':offerItem.description}
const triggerProductData=dataOffer.products[currentProductId];const triggerVariants=getActiveVariants(triggerProductData.variants);const minQty=offerItem.max_quantity;const allow_set_quantities=offerItem.allow_set_quantities;triggerProductData.variants=triggerVariants;const copyright=!dataOffer.brand?'':buildCopyright();const html=`
                <div class="kaktusp-popup__body kaktusp-bd kaktusp-width-container">
                    <div class="kaktusp-popup__main kaktusp-bg-main">
                        <div class="kaktusp-countdown kaktusp-timer">
                            <div class="kaktusp-countdown__wrap">
                                <div class="kaktusp-countdown__msg kaktusp-timer-msg"></div>
                                <div class="kaktusp-countdown__time"></div>
                            </div>
                        </div>

                        <div class="kaktusp-popup__main--wrapper kaktusp-wallpaper">
                            <div class="kaktusp-product__quantity kaktusp-qty kaktusp-hide">
                                <div class="kaktusp-product__quantity--input">
                                <input class="kaktusp-allow-qty-input" type="number" value="${allow_set_quantities}">
                                <input class="kaktusp-qty-input" type="number" value="${minQty}" min="${minQty}">
                                </div>
                            </div>
                        </div>

                        <div class="kaktusp-popup__buttons kaktusp-bg-bottom">
                            <a href="#" class="kaktusp-checkout-btn" data-checkout="${offerItem.checkout_btn_event}" data-redirect="${offerItem.specific_url}"></a>
                        </div>
                        <h2 class="kaktusp-popup__title kaktusp-title"></h2>
                        ${copyright}
                    </div>
                </div>

                <style type="text/css" id="kaktusp-custom-css"></style>
            `;if(allow_set_quantities===1){const clickButton=()=>{const button=document.querySelector('.quantity__button[name="plus"]')
if(button)button.click()
const qtyInput=document.querySelector('.quantity__input')
if(qtyInput){qtyInput.value=minQty;qtyInput.min=minQty;}else if(kaktuspQuantitySelector){document.querySelector(kaktuspQuantitySelector).value=minQty;document.querySelector(kaktuspQuantitySelector).min=minQty;}}
window.addEventListener("DOMcontentloaded",clickButton())}
const element=document.createElement("div");element.classList.add("kaktusp-inline","kaktusp-volume");element.innerHTML=html;const rootDiv=document.getElementById(rootId);rootDiv.append(element);const timerData={minutes:offerObj.offerDesign.main.timer_min,seconds:offerObj.offerDesign.main.timer_sec,display:getAppSelector('.kaktusp-countdown__time',rootId),rootId,offerId:offerObj.offerId,mainOfferId:offerObj.mainOfferId,offerObj:offerObj}
buildTimer(timerData.minutes,timerData.seconds,timerData.display);const countDownTimer=new Timer(timerData);const volumeData=offerItem.volume_discount;const volumeDataOptions=volumeData.options;volumeDataOptions.forEach((option,i)=>{const productData={allow_highlight:volumeData.allow_highlight_option,highlight_option:volumeData.highlight_option,option_number:i+1,product:triggerProductData}
fillVolumeOption(option,productData,rootId);})
buildWidget(offerObj.offerDesign,rootId,countDownTimer);changeWidgetText(element,offerTexts);addVolumeEvents({element,offerObj,rootId,countDownTimer,volumeDataOptions},minQty);volumeOffer={volumeDataOptions,offerObj};setTimeout(()=>{rootDiv.style.display='block';},500);}
function fillVolumeOption(optionData,productData,rootId){const{custom_text,allow_range,range_from,range_to,discount_type,discount_value}=optionData;const{product,allow_highlight,highlight_option,option_number}=productData;const highlightLabel=allow_highlight&&+option_number===+highlight_option?`<div class="kaktusp-option__label kaktusp-save-label kaktusp-highlight"></div>`:'';let discountLabel='';let comparePrice='';let productPrice=getPriceByRate(product.variants[0].variantPrice);let compareTotalPrice=discount_value?`<strike class="kaktusp-compare-price kaktusp-total-compare-price"></strike>`:'';if(discount_value){const discount=discount_type==='%'?`${discount_value}${discount_type}`:currencyFormat(getPriceByRate(discount_value));discountLabel=`<p class="kaktusp-option__save-text kaktusp-discount-text"><span class="kaktusp-save"></span> ${discount}</p>`;comparePrice=`<strike class="kaktusp-compare-price">${currencyFormat(productPrice)}</strike>`;if(discount_type==='%'){productPrice=(+productPrice-(+productPrice*+discount_value / 100)).toFixed(2);}else{productPrice=(+productPrice- +discount_value).toFixed(2);}}
let optionHtml='';if(product.variants.length>1){let variantsHtml='';variantsHtml='<select class="kaktusp-variations">';for(let key in product.variants){let variantPrice=getPriceByRate(product.variants[key]['variantPrice']);if(discount_value){if(discount_type==="%"){variantPrice=(variantPrice-(variantPrice*+discount_value / 100)).toFixed(2);}else{variantPrice=(+variantPrice- +discount_value).toFixed(2);}}
variantsHtml+=`
                        <option
                            value="${product.variants[key]['productId']}"
                            data-price="${getPriceByRate(product.variants[key]['variantPrice'])}"
                            data-store-price="${product.variants[key]['variantPrice']}"
                            data-discount-price="${variantPrice}"
                        >
                            ${product.variants[key]['title']} - ${currencyFormat(variantPrice)}
                        </option>
                    `;}
variantsHtml+='</select>';if(range_from>=1){for(let i=0;i<range_from;i++){optionHtml+=`
                            <div class="kaktusp-option__product">
                                <span class="kaktusp-option__number">#${i + 1}</span>

                                <div class="kaktusp-option__select">
                                    ${variantsHtml}
                                </div>
                            </div>
                        `;}}
if(range_to){optionHtml+=setPlusRow(range_from);}}else{optionHtml=setQtyRow(range_from,range_to,allow_range);}
function setPlusRow(range_from){return`
                    <div class="kaktusp-option__product">
                        <span class="kaktusp-option__number">#${+range_from + 1}</span>

                        <div class="kaktusp-option__plus kaktusp-variations">
                            <svg width="16" height="16" viewBox="0 0 14 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <rect x="6" width="2" height="14" rx="1" fill="currentColor"></rect>
                                <rect x="14" y="6" width="2" height="14" rx="1" transform="rotate(90 14 6)" fill="currentColor"></rect>
                            </svg>
                        </div>
                    </div>
                `}
function setQtyRow(range_from,range_to,allow_range){if(allow_range&&range_to){return`
                        <div class="kaktusp-option__product">
                            <div class="kaktusp-option__qty kaktusp-variations" data-max-qty="${range_to}">
                                <div class="kaktusp-option__qty-btn kaktusp-qty-btn kaktusp-qty-minus">-</div>
                                <input class="kaktusp-option__qty-input" type="number" value="${range_from}" min="${range_from}" max="${range_to}">
                                <div class="kaktusp-option__qty-btn kaktusp-qty-btn kaktusp-qty-plus">+</div>
                            </div>
                        </div>
                    `}else{return`<input type="hidden" class="kaktusp-option__qty-input" type="number" value="${range_from}" min="${range_from}">`}}
const html=`
                ${highlightLabel}

                <div class="kaktusp-option__content">
                    <div class="kaktusp-option__info">
                        <div class="kaktusp-option__radio kaktusp-radio-border">
                            <div class="kaktusp-option__radio-dot kaktusp-radio-bg"></div>
                        </div>

                        <p class="kaktusp-prod-title">${custom_text}</p>
                    </div>

                    <div class="kaktusp-option__result">
                        ${discountLabel}

                        <div class="kaktusp-option__price-block">
                            ${comparePrice}
                            <span class="kaktusp-price"
                                data-price="${getPriceByRate(product.variants[0].variantPrice)}"
                                data-discount-price="${productPrice}"
                                data-storePrice="${product.variants[0]['variantPrice']}"
                                data-productId="${product.variants[0]['productId']}"
                            >
                                ${currencyFormat(productPrice)}
                            </span>
                        </div>

                        <span class="kaktusp-option__total-block">
                            <span class="kaktusp-total"></span>
                            ${compareTotalPrice}
                            <span class="kaktusp-total-price"></span>
                        </span>
                    </div>
                </div>

                <div class="kaktusp-option__products" data-rangeto="${range_to ? range_to : null}">
                    ${optionHtml}
                </div>
            `;const element=document.createElement("div");element.classList.add("kaktusp-option","kaktusp-product-bg","kaktusp-product-border");element.setAttribute('data-discountType',discount_type)
element.setAttribute('data-discount',discount_value)
if(option_number===1){element.classList.add("kaktusp-bg-active");}
element.innerHTML=html;calcVolumeTotalOptionPrice(element);addVolumeRowEvents(element);const plusVariantBtn=element.querySelector('.kaktusp-option__plus');if(plusVariantBtn){addNewRowEvent(plusVariantBtn,element);}
const rootDiv=getAppSelector('.kaktusp-popup__options',rootId);rootDiv.append(element);}
function variantOptionEvent(variant,optionRow){variant.addEventListener('change',()=>{calcVolumeTotalOptionPrice(optionRow);setOptionPrice(optionRow);});}
function addVolumeRowEvents(optionRow){const variations=optionRow.querySelectorAll('select.kaktusp-variations');const qtyInput=optionRow.querySelector('.kaktusp-option__qty-input');const qtyPlusBtn=optionRow.querySelector('.kaktusp-qty-plus');const qtyMinusBtn=optionRow.querySelector('.kaktusp-qty-minus');if(variations.length){variations.forEach(variant=>{variantOptionEvent(variant,optionRow)});}
if(qtyInput&&qtyPlusBtn&&qtyMinusBtn){const maxVal=qtyInput.max;qtyInput.addEventListener('change',function(){changeQtyValue(qtyInput,'change',maxVal);})}}
function addVolumeEvents(params,maxQty){const{element,offerObj,rootId,countDownTimer,volumeDataOptions}=params;const{mainOfferId,offerId,volumeId}=offerObj;const qtyPlusBtn=element.querySelector('.kaktusp-product__quantity--plus');const qtyMinusBtn=element.querySelector('.kaktusp-product__quantity--minus');const qtyInput=element.querySelector('.kaktusp-qty-input');const checkoutBtn=element.querySelector('.kaktusp-checkout-btn');const options=element.querySelectorAll('.kaktusp-option');qtyInput.addEventListener("change",function(e){e.preventDefault();const qty=this;changeQtyValue(qty,'change',offerObj.maxQty);});checkoutBtn.addEventListener('click',function(event){event.preventDefault();element.querySelector('.kaktusp-popup__body').classList.add('kaktusp-preload');fetchProductJSON(window.location.pathname+".json").then((data)=>{console.log(data)
const storePrice=data.product.variants[0].price;const propertyId=makeId(5);const redirectUrl=this.getAttribute('data-redirect');const checkoutEvent=this.getAttribute('data-checkout');const status='Pre-Order';let variantId;if(document.querySelector('.gf_swatches')){const id=window.location.search.split('=')[1];if(id){variantId=id;}else{let idAttr=document.querySelector('shopify-payment-terms').getAttribute('variant-id');variantId=idAttr;}
console.log('variantId0')}else if(document.querySelector('.form input[name="id"]')){variantId=document.querySelector('.form input[name="id"]').value;console.log('variantId1')}else if(document.querySelector('shopify-payment-terms')){let idAttr=document.querySelector('shopify-payment-terms').getAttribute('variant-id');variantId=idAttr;console.log('variantId2');}else if(document.querySelector('select[name="id"]')){const select=document.querySelector('select[name="id"]');variantId=select.value;console.log('variantId3');}else{const query=window.location.search.substring(1);const vars=query.split('&');vars.forEach((v)=>{let pair=v.split('=');if(pair.length>1){variantId=pair[1]
console.log('variantId4')}else{variantId=data.product.variants[0].id;console.log('variantId5');}})}
statisticArr.push(offerId);let productCount=0;let qty;const qty_selector=document.querySelector('input[name="quantity"]');let manual_qty_selector=null;if(kaktuspQuantitySelector){manual_qty_selector=document.querySelector(kaktuspQuantitySelector);}
const qty_input=document.querySelector('.kaktusp-qty-input').value;const allow_qty_input=document.querySelector('.kaktusp-allow-qty-input').value;if(qty_selector){qty=qty_selector.value;}else if(kaktuspQuantitySelector){qty=manual_qty_selector.value;}else{if(allow_qty_input==1){qty=qty_input;}else{qty=1;}}
console.log('variantId',variantId);console.log('qty',qty);addItem(variantId,qty,{offer:propertyId,status}).then(()=>{createPurchaseData(mainOfferId,offerId,variantId,propertyId,storePrice);sendStatistic(mainOfferId,offerId,true);})
setTimeout(()=>{if(offerObj.replaceEvent===1){goToCart();}else{checkoutBtnEvents(checkoutEvent,redirectUrl,rootId,offerObj,countDownTimer);}},1000);}).catch((error)=>{console.log(error)})});options.forEach(option=>{option.addEventListener('click',setActiveOption);})
function setActiveOption(e){e.preventDefault();if(!this.classList.contains('kaktusp-bg-active')){options.forEach(element=>element.classList.remove('kaktusp-bg-active'));this.classList.add('kaktusp-bg-active');removeDefaultColor(offerObj.offerDesign,rootId);changeActiveColor(offerObj.offerDesign,rootId);}}}
function createVolumeProductsData(volumeId,variantId,propertyId){if(!volumeId)return;const localVolumeData=localStorage.getItem('kaktuspVolumeData');let volumeData=localVolumeData?JSON.parse(localVolumeData):[];let productData={volumeId:volumeId,volumeProducts:[],volumeOptions:[]}
if(volumeData.length){const checkVolumeId=volumeData.find(item=>item.volumeId===volumeId);if(checkVolumeId){setProductsData(checkVolumeId);}else{volumeData.push(productData);setProductsData(productData);}}else{volumeData.push(productData);setProductsData(productData);}
localStorage.setItem('kaktuspVolumeData',JSON.stringify(volumeData));function setProductsData(data){data.volumeProducts.push({variantId:variantId,propertyId:propertyId})}}
function createVolumeData(volumeId,volumeDataOptions){if(!volumeId)return;const localVolumeData=localStorage.getItem('kaktuspVolumeData');let volumeData=localVolumeData?JSON.parse(localVolumeData):[];if(volumeData.length){const checkVolumeId=volumeData.find(item=>item.volumeId===volumeId);if(checkVolumeId){volumeDataOptions.forEach(option=>{const{range_from,allow_range,range_to,discount_type,discount_value}=option;checkVolumeId.volumeOptions.push({range_from,allow_range,range_to,discount_type,discount_value});})}}
localStorage.setItem('kaktuspVolumeData',JSON.stringify(volumeData));}
function calcVolumeTotalOptionPrice(optionRow){const comparePriceDiv=optionRow.querySelector('.kaktusp-total-compare-price');const totalPriceDiv=optionRow.querySelector('.kaktusp-total-price');const qtyInput=optionRow.querySelector('.kaktusp-option__qty-input');let totalPrice=0;let totalComparePrice=0;const variations=optionRow.querySelectorAll('select.kaktusp-variations');if(variations.length){variations.forEach(variant=>{const variantPrice=variant.selectedOptions[0].getAttribute('data-price');const variantDiscountPrice=variant.selectedOptions[0].getAttribute('data-discount-price');totalComparePrice+=+variantPrice;totalPrice+=+variantDiscountPrice;})}else{const productPrice=optionRow.querySelector('.kaktusp-price').getAttribute('data-price');const discountPrice=optionRow.querySelector('.kaktusp-price').getAttribute('data-discount-price');totalPrice=qtyInput?+discountPrice*+qtyInput.value:+discountPrice;totalComparePrice=qtyInput?+productPrice*+qtyInput.value:+productPrice;}
if(comparePriceDiv){comparePriceDiv.innerHTML=currencyFormat(totalComparePrice);}
totalPriceDiv.innerHTML=currencyFormat(totalPrice);}
function addNewRowEvent(btn,optionRow){btn.addEventListener('click',function(e){e.preventDefault();const self=this;buildVariantRow(optionRow,self);});}
function buildVariantRow(optionRow,self){const rangeTo=optionRow.querySelector('.kaktusp-option__products').getAttribute('data-rangeto');const products=optionRow.querySelectorAll('.kaktusp-option__product');const plusRowTempl=self.closest('.kaktusp-option__product').cloneNode(true);const selectTempl=self.closest('.kaktusp-option__products').querySelector('.kaktusp-option__select').cloneNode(true);const optionDiv=self.closest('.kaktusp-option__product');const variant=selectTempl.querySelector('select.kaktusp-variations');if(variant.length){variantOptionEvent(variant,optionRow);}
self.remove();optionDiv.append(selectTempl);calcVolumeTotalOptionPrice(optionRow);if(products.length<rangeTo){plusRowTempl.querySelector('.kaktusp-option__number').innerHTML=`#${products.length + 1}`;const btn=plusRowTempl.querySelector('.kaktusp-option__plus');addNewRowEvent(btn,optionRow);optionRow.querySelector('.kaktusp-option__products').append(plusRowTempl);}}
function setOptionPrice(optionRow){const priceBlock=optionRow.querySelector('.kaktusp-option__price-block');const comparePriceDiv=priceBlock.querySelector('.kaktusp-compare-price');const totalPriceDiv=priceBlock.querySelector('.kaktusp-price');const variations=optionRow.querySelectorAll('select.kaktusp-variations');const priceArr=[];let newPrice=0;let newComparePrice=0;variations.forEach(variant=>{const variantPrice=variant.selectedOptions[0].getAttribute('data-price');const variantDiscountPrice=variant.selectedOptions[0].getAttribute('data-discount-price');newPrice=+variantDiscountPrice;newComparePrice=+variantPrice;priceArr.push(+variantPrice)});const allEqual=priceArr.every(v=>v===priceArr[0]);if(allEqual){priceBlock.classList.remove('kaktusp-hide');totalPriceDiv.innerHTML=currencyFormat(newPrice);if(comparePriceDiv){comparePriceDiv.innerHTML=currencyFormat(newComparePrice);}}else{priceBlock.classList.add('kaktusp-hide');}}
function setActiveColor(widgetJson,rootId){const element=getAppSelector('.kaktusp-bg-active',rootId);const obj={"w-prod-bg":{cssOption:"background"},"w-border-color":{cssOption:"border-color"}}
let option=widgetJson.product.active_background;for(let key in obj){let{cssOption}=obj[key];if(cssOption==='background'){option=convertHexToRGBA(option,0.1);}
element.style[cssOption]=option;}}
function changeActiveColor(widgetJson,rootId){const element=getAppSelector('.kaktusp-bg-active',rootId);let option=widgetJson.product.active_background;const obj={"w-prod-bg":{cssOption:"background"},"w-border-color":{cssOption:"border-color"}}
for(let key in obj){let{cssOption}=obj[key];if(cssOption==='background'){option=convertHexToRGBA(option,0.1);}
element.style[cssOption]=option;}}
function removeDefaultColor(widgetJson,rootId){const obj={"w-prod-bg":{data:"product",value:"background",element:"kaktusp-product-bg",cssOption:"background"},"w-border-color":{data:"product",value:"prod_border_color",element:"kaktusp-product-border",cssOption:"border-color"}}
for(let key in obj){let{data,value,element,cssOption}=obj[key];const option=widgetJson[data][value];const elements=getAppSelectorAll('.'+element,rootId);elements.forEach((element)=>{element.style[cssOption]=option;})}}
function convertHexToRGBA(hexCode,opacity=1){let hex=hexCode.replace('#','');if(hex.length===3){hex=`${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;}
const r=parseInt(hex.substring(0,2),16);const g=parseInt(hex.substring(2,4),16);const b=parseInt(hex.substring(4,6),16);if(opacity>1&&opacity<=100){opacity=opacity / 100;}
return`rgba(${r},${g},${b},${opacity})`;};function buildCopyright(){return'<div class="kaktusp-copyright"><a href="https://kaktusapp.com/" target="_blank">Powered by Kaktus</a></div>';}
function getActiveVariants(allVariants,activeVariants){const variants=[];for(let key in allVariants){if(activeVariants&&activeVariants.includes(allVariants[key].productId)){variants.push(allVariants[key]);}else{variants.push(allVariants[key]);}}
return variants;}
function addProductEvents(params){const{element,rootId,offerObj,triggerType,popup_type,offerId,countDownTimer}=params;const{mainOfferId}=offerObj;const qtyPlusBtn=element.querySelector('.kaktusp-product__quantity--plus');const qtyMinusBtn=element.querySelector('.kaktusp-product__quantity--minus');const qtyInput=element.querySelector('.kaktusp-qty-input');const addToCartBtn=element.querySelector('.kaktusp-cart-btn:not(.kaktusp-cart-btn-slider)');const variationSelect=element.querySelector('.kaktusp-variations');const removeBtn=element.querySelector('.kaktusp-remove-btn:not(.kaktusp-remove-btn-slider)');qtyPlusBtn.addEventListener("click",function(e){e.preventDefault();const qty=this.closest('.kaktusp-product__quantity').querySelector('.kaktusp-qty-input');changeQtyValue(qty,'add',offerObj.maxQty);});qtyMinusBtn.addEventListener("click",function(e){e.preventDefault();const qty=this.closest('.kaktusp-product__quantity').querySelector('.kaktusp-qty-input');changeQtyValue(qty,'sub');});qtyInput.addEventListener("change",function(e){e.preventDefault();const qty=this;changeQtyValue(qty,'change',offerObj.maxQty);});if(variationSelect){variationSelect.addEventListener("change",function(e){e.preventDefault();const variantPrice=this.selectedOptions[0].getAttribute('data-price');const variantStorePrice=this.selectedOptions[0].getAttribute('data-store-price');const element=this.closest('.kaktusp-product-item');if(element.querySelector('.kaktusp-cart-btn')){element.querySelector('.kaktusp-cart-btn').setAttribute('data-productId',this.value);element.querySelector('.kaktusp-cart-btn').setAttribute('data-storePrice',variantStorePrice);}else if(element.classList.contains('kaktusp-slider__item')){element.setAttribute('data-productId',this.value);element.setAttribute('data-storePrice',variantStorePrice);}
const activeImg=this.selectedOptions[0].getAttribute('data-image');if(popup_type===popupTypes.inline){const inCart=this.selectedOptions[0].getAttribute('data-added');if(inCart&&inCart==='true'){enableRemoveBtn(element);}else{enableCartBtn(element);}}
changeVariantPrice(element,variantPrice);changeVariantImage(element,activeImg)});}
if(addToCartBtn){addToCartBtn.addEventListener("click",function(e){e.preventDefault();const thisDataCart=this.getAttribute('data-cart');if(thisDataCart==='added')return;const product=this.closest('.kaktusp-product__item');const checkoutBtn=getAppSelector('.kaktusp-checkout-btn',rootId);checkoutBtn.classList.remove('kaktusp-disabled');const qtyInput=this.closest('.kaktusp-product__item').querySelector('.kaktusp-qty-input').value;const variantId=this.getAttribute('data-productId');const storePrice=this.getAttribute('data-storePrice');const discountType=this.closest('.kaktusp-product__item').querySelector('.kaktusp-save')?this.closest('.kaktusp-product__item').querySelector('.kaktusp-save').getAttribute('data-discountType'):null;const discountValue=this.closest('.kaktusp-product__item').querySelector('.kaktusp-save')?this.closest('.kaktusp-product__item').querySelector('.kaktusp-save').getAttribute('data-discount'):null;this.querySelector(".kaktusp-cart-btn-text").classList.add("kaktusp-hide");this.querySelector(".kaktusp-product-cart--active").style.display="none";if(popup_type!=popupTypes.inline){product.querySelector('.kaktusp-qty').classList.add('kaktusp-disabled');if(product.querySelector('.kaktusp-variations')){product.querySelector('.kaktusp-variations').classList.add('kaktusp-disabled');}}
this.classList.add('kaktusp-preload');setTimeout(()=>{this.classList.remove('kaktusp-preload');this.classList.add('kaktusp-hide');removeBtn.classList.remove('kaktusp-hide');removeBtn.querySelector(".kaktusp-remove-btn-text").classList.remove("kaktusp-hide");removeBtn.querySelector(".kaktusp-product-cart").style.display="flex";product.classList.add('kaktusp-product-added');if(popup_type===popupTypes.inline){setVariantAddedToCart(product,variantId,true);checkoutBtn.classList.remove('kaktusp-hide');}},1000);if(popup_type!=popupTypes.inline){showAddedProduct(product,rootId);}
statisticArr.push(offerId);if(thisDataCart==='add'){const propertyId=makeId(5);addItem(variantId,qtyInput,{offer:propertyId}).then(()=>{createPurchaseData(mainOfferId,offerId,variantId,propertyId,storePrice);sendStatistic(mainOfferId,offerId,true);checkAddedProduct(rootId,offerObj);createAddedProductsData(variantId,propertyId,rootId);if(popup_type!=popupTypes.inline){this.setAttribute('data-cart','added');}
this.setAttribute('data-property',propertyId);if(!offerObj.goToCheckoutAction){if(this.classList.contains('show-accepted')&&(!offerObj.closePopupNumber||offerObj.closePopupNumber>offerObj.popupNumberCount)&&offerObj.allowProducts){setTimeout(()=>{if(offerObj.funnelsObj!=null&&offerObj.funnelsObj.accepted!=null&&offerObj.funnelsObj.accepted.products.length){showFunnel([offerObj,offerObj.funnelsObj.accepted,triggerType,rootId,countDownTimer]);offerObj.popupNumberCount++;}else{if(offerObj.allowPageReload){if(popup_type==popupTypes.inline){location.reload()}else{offerObj.pageReload=true;}}}},1000);}else{if(offerObj.allowPageReload){if(popup_type==popupTypes.inline){location.reload()}else{offerObj.pageReload=true;}}}}else{createOrder();}});}else if(thisDataCart==='replace'){const propertyId=makeId(5);removeItemById(currentProductId).then(function(){addItem(variantId,qtyInput,{offer:propertyId}).then(function(){currentProductId=variantId;createPurchaseData(mainOfferId,offerId,variantId,propertyId,storePrice);sendStatistic(mainOfferId,offerId,true);setTimeout(()=>{if(offerObj.replaceEvent===1){createOrder();}else{goToCart();}},1000);});})}});}
if(removeBtn){removeBtn.addEventListener("click",function(e){e.preventDefault();const product=this.closest('.kaktusp-product__item');const addProductBtn=product.querySelector('.kaktusp-cart-btn');const variantId=addProductBtn.getAttribute('data-productId');const propertyId=addProductBtn.getAttribute('data-property');this.querySelector(".kaktusp-remove-btn-text").classList.add("kaktusp-hide");this.querySelector(".kaktusp-product-cart").style.display="none";this.classList.add('kaktusp-preload');setTimeout(()=>{this.classList.remove('kaktusp-preload');this.classList.add('kaktusp-hide');addProductBtn.classList.remove('kaktusp-hide');addProductBtn.querySelector(".kaktusp-cart-btn-text").classList.remove("kaktusp-hide");addProductBtn.querySelector(".kaktusp-product-cart--active").style.display="flex";addProductBtn.setAttribute('data-cart','add');if(popup_type!=popupTypes.inline){product.querySelector('.kaktusp-qty').classList.remove("kaktusp-disabled");if(product.querySelector('.kaktusp-variations')){product.querySelector('.kaktusp-variations').classList.remove("kaktusp-disabled");}}else{setVariantAddedToCart(product,variantId,false);}
product.classList.remove('kaktusp-product-added');},1000);fetchCart().then(dataCart=>{let currentProductLine=0;dataCart.items.forEach((item,i)=>{if(parseInt(item.id)===parseInt(variantId)&&(item.properties&&(propertyId===item.properties.offer))){currentProductLine=i+1;}else if(this.classList.contains('kaktusp-remove-inline')&&parseInt(item.id)===parseInt(variantId)){currentProductLine=i+1;}});removeItemByLine(currentProductLine).then(()=>{addProductBtn.removeAttribute('data-property');if(offerObj.allowPageReload&&popup_type==popupTypes.inline){location.reload()}}).catch(error=>console.error(error));});});}
function setVariantAddedToCart(product,variantId,param){if(product.querySelector('.kaktusp-variations')){const varianOptions=product.querySelectorAll('.kaktusp-variations option');varianOptions.forEach(option=>{const optionValue=parseInt(option.value);if(parseInt(variantId)===optionValue){option.setAttribute('data-added',param);}});}}
function enableRemoveBtn(product){const addToCartBtn=product.querySelector('.kaktusp-cart-btn');const removeBtn=product.querySelector('.kaktusp-remove-btn');addToCartBtn.classList.add('kaktusp-hide');addToCartBtn.querySelector(".kaktusp-product-cart--active").style.display="none";addToCartBtn.querySelector(".kaktusp-cart-btn-text").classList.add("kaktusp-hide");removeBtn.classList.remove('kaktusp-hide');removeBtn.querySelector(".kaktusp-remove-btn-text").classList.remove("kaktusp-hide");removeBtn.querySelector(".kaktusp-product-cart").style.display="flex";}
function enableCartBtn(product){const addToCartBtn=product.querySelector('.kaktusp-cart-btn');const removeBtn=product.querySelector('.kaktusp-remove-btn');addToCartBtn.classList.remove('kaktusp-hide');addToCartBtn.querySelector(".kaktusp-product-cart--active").style.display="flex";addToCartBtn.querySelector(".kaktusp-cart-btn-text").classList.remove("kaktusp-hide");removeBtn.classList.add('kaktusp-hide');removeBtn.querySelector(".kaktusp-remove-btn-text").classList.add("kaktusp-hide");removeBtn.querySelector(".kaktusp-product-cart").style.display="none";}}
function showRemoveButton(parentNode){const products=parentNode.querySelectorAll('.kaktusp-product__item');if(!products.length)return;let cartProducts=[];fetchCart().then(dataCart=>{if(dataCart.items.length){dataCart.items.forEach(item=>cartProducts.push(item.id));products.forEach(product=>{const addToCartBtn=product.querySelector('.kaktusp-cart-btn');const removeBtn=product.querySelector('.kaktusp-remove-btn');const productId=parseInt(addToCartBtn.getAttribute('data-productId'));if(cartProducts.includes(productId)){addToCartBtn.classList.add('kaktusp-hide');removeBtn.classList.remove('kaktusp-hide');product.querySelector('.kaktusp-qty').classList.add('kaktusp-disabled');}
if(product.querySelector('.kaktusp-variations')){const varianOptions=product.querySelectorAll('.kaktusp-variations option');varianOptions.forEach(option=>{const optionValue=parseInt(option.value);if(cartProducts.includes(optionValue)){option.setAttribute('data-added',true);}});}});}});}
function createAddedProductsData(variantId,propertyId,rootId){const targetProduct=getAppSelector('.kaktusp-alert-prod',rootId);if(!targetProduct)return;const targetId=targetProduct.getAttribute('data-target-id');if(!targetId)return;const localProductsData=localStorage.getItem('kaktuspProductsData');productsData=localProductsData?JSON.parse(localProductsData):productsData;let productData={targetProductId:targetId,funnelProducts:[]}
if(productsData.length){const checkTargetId=productsData.find(item=>item.targetProductId===targetId);if(checkTargetId){setProductsData(checkTargetId);}else{productsData.push(productData);setProductsData(productData);}}else{productsData.push(productData);setProductsData(productData);}
function setProductsData(data){data.funnelProducts.push({variantId:variantId,propertyId:propertyId})}
localStorage.setItem('kaktuspProductsData',JSON.stringify(productsData));}
function checkAddedProduct(rootId,offerObj){offerObj.currentProductNumber++;if(!offerObj.maxProductNumber)return;if(offerObj.currentProductNumber>=offerObj.maxProductNumber){const cartBtns=getAppSelectorAll('.kaktusp-cart-btn',rootId);cartBtns.forEach(item=>{item.classList.add('kaktusp-disabled');item.setAttribute('data-cart','off');});}}
function calcVariantsDiscountPrice(product,variants){const variantPrice=getPriceByRate(parseFloat(variants['variantPrice']));const discountVal=product.discount_type!=="%"?getPriceByRate(product.discount):product.discount;if(product.discount_type==="%"){return(variantPrice-(variantPrice*+discountVal / 100)).toFixed(2);}else{return(+variantPrice- +discountVal).toFixed(2);}}
function changeVariantPrice(element,price){const priceContainer=element.querySelector(".kaktusp-compare-price");const mainPriceContainer=element.querySelector(".kaktusp-price");const discountContainer=element.querySelector(".kaktusp-save");let newPrice=price;if(discountContainer){const discountValue=discountContainer.getAttribute("data-discount");const discountType=discountContainer.getAttribute("data-discountType");if(discountType==="%"){newPrice=(+price-(+price*+discountValue / 100)).toFixed(2);}else{newPrice=(+price- +discountValue).toFixed(2);}}
if(priceContainer){priceContainer.innerText=currencyFormat(price);}
mainPriceContainer.innerText=currencyFormat(newPrice)}
function changeVariantImage(element,activeImage){if(!activeImage)return;const image=element.querySelector('.kaktusp-product__img img');image.setAttribute('src',activeImage);}
function changeQtyValue(qty,type,maxVal){let currentQty=+qty.value;let minValue=+qty.getAttribute('min');let nextQty;switch(type){case'add':{if(maxVal){maxVal=+maxVal;nextQty=currentQty<maxVal?currentQty+1:maxVal;}else{nextQty=currentQty+1;}
break;}
case'sub':{currentQty===minValue?nextQty=minValue:nextQty=currentQty-1;break;}
case'change':{if(maxVal){maxVal=+maxVal;nextQty=currentQty<maxVal?currentQty:maxVal;}else{nextQty=currentQty;}
if(nextQty<=0){nextQty=1;}}}
qty.value=nextQty;}
function makeId(length){let result='';const characters='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';const charactersLength=characters.length;for(let i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}
return result;}
function changeWidgetText(element,offerTexts){const titleRow=element.querySelector('.kaktusp-title');titleRow.innerText=offerTexts.title;if(offerTexts.allow_set_description){titleRow.classList.remove('kaktusp-hide');titleRow.innerText=offerTexts.description;}else{titleRow.classList.add('kaktusp-hide');}}
function showAddedProduct(product,rootId){const topSection=getAppSelector('.kaktusp-popup__top',rootId);const cartImg=getAppSelector('.kaktusp-popup__cart-alert--img',rootId);const productSpan=getAppSelector('.kaktusp-alert-prod span',rootId);productSpan.innerText="";cartImg.innerHTML="";const img=product.querySelector(".kaktusp-product__img img").cloneNode(true);const title=product.querySelector(".kaktusp-prod-title").innerText;productSpan.innerText=title;cartImg.append(img);if(window.innerWidth<768){slideDown(topSection,1000);setTimeout(function(){slideUp(topSection,1000)},3000);}else{topSection.style.display="flex";}}
window.addEventListener('resize',function(){const topSection=iframe?iframe.contentWindow.document.querySelector('.kaktusp-popup__top'):false;if(topSection){if(window.innerWidth<768){topSection.style.display="none";}else{topSection.style.display="flex";}}});function checkoutBtnEvents(val,customUrl,rootId,offerObj,countDownTimer){const goCheckout='1';const goCart='2';const goCustomUrl='3';const closePopUp='4';switch(val){case goCheckout:createOrder();break;case goCart:goToCart();break;case goCustomUrl:if(customUrl)location.href=`https://${customUrl}`;break;case closePopUp:closeModal('1',rootId,offerObj,countDownTimer);break;default:createOrder();break;}}
function buildWidget(dataOffer,rootId,countDownTimer){fillWidget(dataOffer,rootId,countDownTimer);fillWidgetSettings(dataOffer,rootId);}
const dataJsonTranslation={"kaktusp-title":{data:"translation",value:"title",input:"kaktusp-title-input",element:"kaktusp-title"},"kaktusp-description":{data:"translation",value:"description",input:"kaktusp-description-input",element:"kaktusp-description"},"kaktusp-cart-btn-text":{data:"translation",value:"add_to_cart_btn",input:"kaktusp-cart-btn-input",element:"kaktusp-cart-btn-text"},"kaktusp-cart-btn-added-text":{data:"translation",value:"add_to_cart_btn_added",input:"kaktusp-cart-btn-added-input",element:"kaktusp-cart-btn-added-text"},"kaktusp-cart-btn-text-upsell":{data:"translation",value:"add_to_cart_btn_upsell",input:"kaktusp-cart-btn-upsell-input",element:"kaktusp-cart-btn-text-upsell"},"kaktusp-cart-btn-added-text-upsell":{data:"translation",value:"add_to_cart_btn_added_upsell",input:"kaktusp-cart-btn-added-upsell-input",element:"kaktusp-cart-btn-added-text-upsell"},"kaktusp-remove-btn-text":{data:"translation",value:"remove_btn",element:"kaktusp-remove-btn-text"},"kaktusp-reject-btn-text":{data:"translation",value:"reject_btn",input:"kaktusp-reject-btn-input",element:"kaktusp-reject-btn-text"},"kaktusp-checkout-btn-text":{data:"translation",value:"checkout_btn",input:"kaktusp-checkout-btn-input",element:"kaktusp-checkout-btn"},"kaktusp-save-text":{data:"translation",value:"save_text",input:"kaktusp-save-input",element:"kaktusp-save"},"kaktusp-total-text":{data:"translation",value:"total_btn",input:"kaktusp-total-input",element:"kaktusp-total"},"kaktusp-before-alert-text":{data:"translation",value:"alert_before_text",input:"kaktusp-alert-input",element:"kaktusp-alert-text"},"kaktusp-before-alert-upsell-text":{data:"translation",value:"alert_before_text_upsell",input:"kaktusp-before-alert-upsell-input",element:"kaktusp-alert-upsell"},"kaktusp-timer-msg":{data:"translation",value:"timer_msg",input:"kaktusp-timer-msg-input",element:"kaktusp-timer-msg"},"kaktusp-highlight-text":{data:"translation",value:"highlight_text",element:"kaktusp-highlight"}};const dataJsonTopSection={"kaktusp-background-top":{data:"top",value:"background_top",input:"kaktusp-bg-top-input",element:"kaktusp-bg-top",cssOption:"background"},"kaktusp-close-btn-bd-radius":{data:"top",value:"close_border_radius",input:"kaktusp-close-border-radius",element:"kaktusp-close",cssOption:"border-radius",cssType:"size"},"kaktusp-alert-text-color":{data:"top",value:"alert_text_color",input:"kaktusp-alert-text-color",element:"kaktusp-alert-text",cssOption:"color"},"kaktusp-alert-text-font-size":{data:"top",value:"alert_text_font_size",input:"kaktusp-alert-text-font-size",element:"kaktusp-alert-text",cssOption:"font-size",cssType:"size"},"kaktusp-alert-text-font-weight":{data:"top",value:"alert_text_font_weight",input:"kaktusp-alert-text-font-weight",element:"kaktusp-alert-text",cssOption:"font-weight"},"kaktusp-alert-text-font-style":{data:"top",value:"alert_text_font_style",input:"kaktusp-alert-text-font-style",element:"kaktusp-alert-text",cssOption:"font-style"},"kaktusp-alert-text-line-height":{data:"top",value:"alert_text_line_height",input:"kaktusp-alert-text-line-height",element:"kaktusp-alert-text",cssOption:"line-height",cssType:"size"},"kaktusp-alert-prod-color":{data:"top",value:"alert_prod_color",input:"kaktusp-alert-prod-color",element:"kaktusp-alert-prod",cssOption:"color"},"kaktusp-alert-prod-font-size":{data:"top",value:"alert_prod_font_size",input:"kaktusp-alert-prod-font-size",element:"kaktusp-alert-prod",cssOption:"font-size",cssType:"size"},"kaktusp-alert-prod-font-weight":{data:"top",value:"alert_prod_font_weight",input:"kaktusp-alert-prod-font-weight",element:"kaktusp-alert-prod",cssOption:"font-weight"},"kaktusp-alert-prod-font-style":{data:"top",value:"alert_prod_font_style",input:"kaktusp-alert-prod-font-style",element:"kaktusp-alert-prod",cssOption:"font-style"},"kaktusp-alert-prod-line-height":{data:"top",value:"alert_prod_line_height",input:"kaktusp-alert-prod-line-height",element:"kaktusp-alert-prod",cssOption:"line-height",cssType:"size"}};const dataJsonMainSection={"kaktusp-bg-main":{data:"main",value:"background_main",input:"kaktusp-bg-main-input",element:"kaktusp-bg-main",cssOption:"background"},"kaktusp-bg-heading":{data:"main",value:"background_heading",element:"kaktusp-bg-heading",cssOption:"background"},"kaktusp-timer":{data:"main",value:"timer_bg",input:"kaktusp-timer-bg",element:"kaktusp-timer",cssOption:"background"},"kaktusp-timer-border-radius-left":{data:"main",value:"timer_border_radius",input:"kaktusp-timer-border-radius",element:"kaktusp-timer",cssOption:"border-bottom-left-radius",cssType:"size"},"kaktusp-timer-border-radius-right":{data:"main",value:"timer_border_radius",input:"kaktusp-timer-border-radius",element:"kaktusp-timer",cssOption:"border-bottom-right-radius",cssType:"size"},"kaktusp-timer-font-size":{data:"main",value:"timer_font_size",input:"kaktusp-timer-fs",element:"kaktusp-timer",cssOption:"font-size",cssType:"size"},"kaktusp-timer-color":{data:"main",value:"timer_color",input:"kaktusp-timer-color",element:"kaktusp-timer",cssOption:"color"},"kaktusp-timer-font-weight":{data:"main",value:"timer_font_weight",input:"kaktusp-timer-font-weight",element:"kaktusp-timer",cssOption:"font-weight"},"kaktusp-timer-font-style":{data:"main",value:"timer_font_style",input:"kaktusp-timer-font-style",element:"kaktusp-timer",cssOption:"font-style"},"kaktusp-timer-line-height":{data:"main",value:"timer_line_height",input:"kaktusp-timer-line-height",element:"kaktusp-timer",cssOption:"line-height",cssType:"size"},"kaktusp-title-font-size":{data:"main",value:"title_font_size",input:"kaktusp-title-fs",element:"kaktusp-title",cssOption:"font-size",cssType:"size"},"kaktusp-title-color":{data:"main",value:"title_color",input:"kaktusp-title-color",element:"kaktusp-title",cssOption:"color"},"kaktusp-title-font-weight":{data:"main",value:"title_font_weight",input:"kaktusp-title-font-weight",element:"kaktusp-title",cssOption:"font-weight"},"kaktusp-title-font-style":{data:"main",value:"title_font_style",input:"kaktusp-title-font-style",element:"kaktusp-title",cssOption:"font-style"},"kaktusp-title-line-height":{data:"main",value:"title_line_height",input:"kaktusp-title-line-height",element:"kaktusp-title",cssOption:"line-height",cssType:"size"},"kaktusp-description-font-size":{data:"main",value:"description_font_size",input:"kaktusp-description-fs",element:"kaktusp-description",cssOption:"font-size",cssType:"size"},"kaktusp-description-color":{data:"main",value:"description_color",input:"kaktusp-description-color",element:"kaktusp-description",cssOption:"color"},"kaktusp-description-font-weight":{data:"main",value:"description_font_weight",input:"kaktusp-description-font-weight",element:"kaktusp-description",cssOption:"font-weight"},"kaktusp-description-font-style":{data:"main",value:"description_font_style",input:"kaktusp-description-font-style",element:"kaktusp-description",cssOption:"font-style"},"kaktusp-description-line-height":{data:"main",value:"description_line_height",input:"kaktusp-description-line-height",element:"kaktusp-description",cssOption:"line-height",cssType:"size"},"kaktusp-border-width":{data:"main",value:"border_width",input:"kaktusp-border-size",element:"kaktusp-bd",cssOption:"border-width",cssType:"size"},"kaktusp-border-color":{data:"main",value:"border_color",input:"kaktusp-border-color",element:"kaktusp-bd",cssOption:"border-color"},"kaktusp-border-radius":{data:"main",value:"border_radius",input:"kaktusp-border-radius",element:"kaktusp-bd",cssOption:"border-radius",cssType:"size"},"kaktusp-border-radius-top":{data:"main",value:"border_radius",input:"w-border-radius",element:"kaktusp-bg-top",cssOption:"border-top-right-radius",cssType:"size"},"kaktusp-total-color":{data:"main",value:"total_color",input:"kaktusp-total-color",element:"kaktusp-total",cssOption:"color"},"kaktusp-total-font-size":{data:"main",value:"total_font_size",input:"kaktusp-total-font-size",element:"kaktusp-total",cssOption:"font-size",cssType:"size"},"kaktusp-total-font-weight":{data:"main",value:"total_font_weight",input:"kaktusp-total-font-weight",element:"kaktusp-total",cssOption:"font-weight"},"kaktusp-total-font-style":{data:"main",value:"total_font_style",input:"kaktusp-total-font-style",element:"kaktusp-total",cssOption:"font-style"},"kaktusp-total-line-height":{data:"main",value:"total_line_height",input:"kaktusp-total-line-height",element:"kaktusp-total",cssOption:"line-height",cssType:"size"},"kaktusp-total-price-color":{data:"main",value:"total_price_color",input:"kaktusp-total-price-color",element:"kaktusp-total-price",cssOption:"color"},"kaktusp-total-price-font-size":{data:"main",value:"total_price_font_size",input:"kaktusp-total-price-font-size",element:"kaktusp-total-price",cssOption:"font-size",cssType:"size"},"kaktusp-total-price-font-weight":{data:"main",value:"total_price_font_weight",input:"kaktusp-total-price-font-weight",element:"kaktusp-total-price",cssOption:"font-weight"},"kaktusp-total-price-font-style":{data:"main",value:"total_price_font_style",input:"kaktusp-total-price-font-style",element:"kaktusp-total-price",cssOption:"font-style"},"kaktusp-total-price-line-height":{data:"main",value:"total_price_line_height",input:"kaktusp-total-price-line-height",element:"kaktusp-total-price",cssOption:"line-height",cssType:"size"},"kaktusp-product-name-color":{data:"main",value:"product_name_color",element:"kaktusp-product-name",cssOption:"color"},"kaktusp-product-name-font-size":{data:"main",value:"product_name_font_size",element:"kaktusp-product-name",cssOption:"font-size",cssType:"size"},"kaktusp-product-name-font-weight":{data:"main",value:"product_name_font_weight",element:"kaktusp-product-name",cssOption:"font-weight"},"kaktusp-product-name-font-style":{data:"main",value:"product_name_font_style",element:"kaktusp-product-name",cssOption:"font-style"},"kaktusp-product-name-line-height":{data:"main",value:"product_name_line_height",element:"kaktusp-product-name",cssOption:"line-height",cssType:"size"},"kaktusp-product-price-color":{data:"main",value:"product_price_color",element:"kaktusp-product-price",cssOption:"color"},"kaktusp-product-price-font-size":{data:"main",value:"product_price_font_size",element:"kaktusp-product-price",cssOption:"font-size",cssType:"size"},"kaktusp-product-price-font-weight":{data:"main",value:"product_price_font_weight",element:"kaktusp-product-price",cssOption:"font-weight"},"kaktusp-product-price-font-style":{data:"main",value:"product_price_font_style",element:"kaktusp-product-price",cssOption:"font-style"},"kaktusp-product-price-line-height":{data:"main",value:"product_price_line_height",element:"kaktusp-product-price",cssOption:"line-height",cssType:"size"}};const dataJsonBottomSection={"kaktusp-background-bottom":{data:"bottom",value:"background_bottom",input:"kaktusp-bg-bottom-input",element:"kaktusp-bg-bottom",cssOption:"background"},"kaktusp-reject-btn-bd-radius":{data:"bottom",value:"reject_btn_border_radius",input:"kaktusp-reject-btn-bd-radius",element:"kaktusp-reject-btn",cssOption:"border-radius",cssType:"size"},"kaktusp-reject-btn-font-size":{data:"bottom",value:"reject_btn_font_size",input:"kaktusp-reject-btn-font-size",element:"kaktusp-reject-btn",cssOption:"font-size",cssType:"size"},"kaktusp-reject-btn-font-weight":{data:"bottom",value:"reject_btn_font_weight",input:"kaktusp-reject-btn-font-weight",element:"kaktusp-reject-btn",cssOption:"font-weight"},"kaktusp-reject-btn-font-style":{data:"bottom",value:"reject_btn_font_style",input:"kaktusp-reject-btn-font-style",element:"kaktusp-reject-btn",cssOption:"font-style"},"kaktusp-reject-btn-line-height":{data:"bottom",value:"reject_btn_line_height",input:"kaktusp-reject-btn-line-height",element:"kaktusp-reject-btn",cssOption:"line-height",cssType:"size"},"kaktusp-reject-btn-padding-top":{data:"bottom",value:"reject_btn_padding_t_b",input:"kaktusp-reject-btn-padding-t-b",element:"kaktusp-reject-btn",cssOption:"padding-top",cssType:"size"},"kaktusp-reject-btn-padding-bottom":{data:"bottom",value:"reject_btn_padding_t_b",input:"kaktusp-reject-btn-padding-t-b",element:"kaktusp-reject-btn",cssOption:"padding-bottom",cssType:"size"},"kaktusp-reject-btn-padding-left":{data:"bottom",value:"reject_btn_padding_l_r",input:"kaktusp-reject-btn-padding-l-r",element:"kaktusp-reject-btn",cssOption:"padding-left",cssType:"size"},"kaktusp-reject-btn-padding-right":{data:"bottom",value:"reject_btn_padding_l_r",input:"kaktusp-reject-btn-padding-l-r",element:"kaktusp-reject-btn",cssOption:"padding-right",cssType:"size"},"kaktusp-checkout-btn-bd-radius":{data:"bottom",value:"checkout_btn_border_radius",input:"kaktusp-checkout-btn-bd-radius",element:"kaktusp-checkout-btn",cssOption:"border-radius",cssType:"size"},"kaktusp-checkout-btn-font-size":{data:"bottom",value:"checkout_btn_font_size",input:"kaktusp-checkout-btn-font-size",element:"kaktusp-checkout-btn",cssOption:"font-size",cssType:"size"},"kaktusp-checkout-btn-font-weight":{data:"bottom",value:"checkout_btn_font_weight",input:"kaktusp-checkout-btn-font-weight",element:"kaktusp-checkout-btn",cssOption:"font-weight"},"kaktusp-checkout-btn-font-style":{data:"bottom",value:"checkout_btn_font_style",input:"kaktusp-checkout-btn-font-style",element:"kaktusp-checkout-btn",cssOption:"font-style"},"kaktusp-checkout-btn-line-height":{data:"bottom",value:"checkout_btn_line_height",input:"kaktusp-checkout-btn-line-height",element:"kaktusp-checkout-btn",cssOption:"line-height",cssType:"size"},"kaktusp-checkout-btn-padding-top":{data:"bottom",value:"checkout_btn_padding_t_b",input:"kaktusp-checkout-btn-padding-t-b",element:"kaktusp-checkout-btn",cssOption:"padding-top",cssType:"size"},"kaktusp-checkout-btn-padding-bottom":{data:"bottom",value:"checkout_btn_padding_t_b",input:"kaktusp-checkout-btn-padding-t-b",element:"kaktusp-checkout-btn",cssOption:"padding-bottom",cssType:"size"},"kaktusp-checkout-btn-padding-left":{data:"bottom",value:"checkout_btn_padding_l_r",input:"kaktusp-checkout-btn-padding-l-r",element:"kaktusp-checkout-btn",cssOption:"padding-left",cssType:"size"},"kaktusp-checkout-btn-padding-right":{data:"bottom",value:"checkout_btn_padding_l_r",input:"kaktusp-checkout-btn-padding-l-r",element:"kaktusp-checkout-btn",cssOption:"padding-right",cssType:"size"}};const dataJsonBtnStyle={"kaktusp-reject-btn-bg":{data:"bottom",value:"reject_btn_bg",secondValue:"reject_btn_bg_hover",input:"kaktusp-reject-btn-bg",inputHover:"kaktusp-reject-btn-bg-h",element:"kaktusp-reject-btn",cssOption:"background"},"kaktusp-reject-btn-color":{data:"bottom",value:"reject_btn_font_color",secondValue:"reject_btn_font_color_hover",input:"kaktusp-reject-btn-color",inputHover:"kaktusp-reject-btn-color-h",element:"kaktusp-reject-btn",cssOption:"color"},"kaktusp-reject-btn-color-icon":{data:"bottom",value:"reject_btn_font_color",secondValue:"reject_btn_font_color_hover",input:"kaktusp-reject-btn-color",inputHover:"kaktusp-reject-btn-color-h",element:"kaktusp-reject-btn",cssOption:"fill"},"kaktusp-checkout-btn-bg":{data:"bottom",value:"checkout_btn_bg",secondValue:"checkout_btn_bg_hover",input:"kaktusp-checkout-btn-bg",inputHover:"kaktusp-checkout-btn-bg-h",element:"kaktusp-checkout-btn",cssOption:"background"},"kaktusp-checkout-btn-color":{data:"bottom",value:"checkout_btn_font_color",secondValue:"checkout_btn_font_color_hover",input:"kaktusp-checkout-btn-color",inputHover:"kaktusp-checkout-btn-color-h",element:"kaktusp-checkout-btn",cssOption:"color"},"kaktusp-close-bg-color":{data:"top",value:"close_bg_color",secondValue:"close_bg_color_hover",input:"kaktusp-close-bg-color",inputHover:"kaktusp-close-bg-color-h",element:"kaktusp-close",cssOption:"background"},"kaktusp-close-color":{data:"top",value:"close_color",secondValue:"close_color_hover",input:"kaktusp-close-color",inputHover:"kaktusp-close-color-h",element:"kaktusp-close",cssOption:"color"},"kaktusp-cart-btn-bg":{data:"product",value:"cart_btn_bg",secondValue:"cart_btn_bg_hover",input:"kaktusp-cart-btn-bg",inputHover:"kaktusp-cart-btn-bg-h",element:"kaktusp-cart-btn",cssOption:"background"},"kaktusp-cart-btn-color":{data:"product",value:"cart_btn_font_color",secondValue:"cart_btn_font_color_hover",input:"kaktusp-cart-btn-color",inputHover:"kaktusp-cart-btn-color-h",element:"kaktusp-cart-btn",cssOption:"color"},"kaktusp-cart-btn-color-icon":{data:"product",value:"cart_btn_font_color",secondValue:"cart_btn_font_color_hover",input:"kaktusp-cart-btn-color",inputHover:"kaktusp-cart-btn-color-h",element:"kaktusp-cart-btn",cssOption:"fill"},"kaktusp-qty-btn-bg":{data:"product",value:"qty_btn_bg",secondValue:"qty_btn_bg_hover",input:"kaktusp-qty-btn-bg",inputHover:"kaktusp-qty-btn-bg-h",element:"kaktusp-qty-btn",cssOption:"background"},"kaktusp-qty-btn-color":{data:"product",value:"qty_btn_color",secondValue:"qty_btn_color_hover",input:"kaktusp-qty-btn-color",inputHover:"kaktusp-qty-btn-color-h",element:"kaktusp-qty-btn",cssOption:"color"},"kaktusp-remove-btn-bg":{data:"product",value:"remove_btn_bg",secondValue:"remove_btn_bg_hover",element:"kaktusp-remove-btn",cssOption:"background"},"kaktusp-remove-btn-color":{data:"product",value:"remove_btn_font_color",secondValue:"remove_btn_font_color_hover",element:"kaktusp-remove-btn",cssOption:"color"},"kaktusp-remove-btn-color-icon":{data:"product",value:"remove_btn_font_color",secondValue:"remove_btn_font_color_hover",element:"kaktusp-remove-btn",cssOption:"fill"}};const dataJsonProductStyle={"kaktusp-prod-bg-img":{data:"product",value:"background_img",input:"kaktusp-prod-bg-img",element:"kaktusp-product-item",cssOption:"background"},"kaktusp-prod-bg":{data:"product",value:"background",input:"kaktusp-prod-bg",element:"kaktusp-product-bg",cssOption:"background"},"kaktusp-cart-btn-bd-radius":{data:"product",value:"cart_btn_border_radius",input:"kaktusp-cart-btn-radius",element:"kaktusp-cart-btn",cssOption:"border-radius",cssType:"size"},"kaktusp-cart-btn-font-size":{data:"product",value:"cart_btn_font_size",input:"kaktusp-cart-btn-font-size",element:"kaktusp-cart-btn",cssOption:"font-size",cssType:"size"},"kaktusp-cart-btn-font-weight":{data:"product",value:"cart_btn_font_weight",input:"kaktusp-cart-btn-font-weight",element:"kaktusp-cart-btn",cssOption:"font-weight"},"kaktusp-cart-btn-font-style":{data:"product",value:"cart_btn_font_style",input:"kaktusp-cart-btn-font-style",element:"kaktusp-cart-btn",cssOption:"font-style"},"kaktusp-cart-btn-line-height":{data:"product",value:"cart_btn_line_height",input:"kaktusp-cart-btn-line-height",element:"kaktusp-cart-btn",cssOption:"line-height",cssType:"size"},"kaktusp-cart-btn-padding-top":{data:"product",value:"cart_btn_padding_t_b",input:"kaktusp-cart-btn-padding-t-b",element:"kaktusp-cart-btn",cssOption:"padding-top",cssType:"size"},"kaktusp-cart-btn-padding-bottom":{data:"product",value:"cart_btn_padding_t_b",input:"kaktusp-cart-btn-padding-t-b",element:"kaktusp-cart-btn",cssOption:"padding-bottom",cssType:"size"},"kaktusp-cart-btn-padding-left":{data:"product",value:"cart_btn_padding_l_r",input:"kaktusp-cart-btn-padding-l-r",element:"kaktusp-cart-btn",cssOption:"padding-left",cssType:"size"},"kaktusp-cart-btn-padding-right":{data:"product",value:"cart_btn_padding_l_r",input:"kaktusp-cart-btn-padding-l-r",element:"kaktusp-cart-btn",cssOption:"padding-right",cssType:"size"},"kaktusp-remove-btn-bd-radius":{data:"product",value:"remove_btn_border_radius",element:"kaktusp-remove-btn",cssOption:"border-radius",cssType:"size"},"kaktusp-remove-btn-font-size":{data:"product",value:"remove_btn_font_size",element:"kaktusp-remove-btn",cssOption:"font-size",cssType:"size"},"kaktusp-remove-btn-font-weight":{data:"product",value:"remove_btn_font_weight",element:"kaktusp-remove-btn",cssOption:"font-weight"},"kaktusp-remove-btn-font-style":{data:"product",value:"remove_btn_font_style",element:"kaktusp-remove-btn",cssOption:"font-style"},"kaktusp-remove-btn-line-height":{data:"product",value:"remove_btn_line_height",element:"kaktusp-remove-btn",cssOption:"line-height",cssType:"size"},"kaktusp-remove-btn-padding-top":{data:"product",value:"remove_btn_padding_t_b",element:"kaktusp-remove-btn",cssOption:"padding-top",cssType:"size"},"kaktusp-remove-btn-padding-bottom":{data:"product",value:"remove_btn_padding_t_b",element:"kaktusp-remove-btn",cssOption:"padding-bottom",cssType:"size"},"kaktusp-remove-btn-padding-left":{data:"product",value:"remove_btn_padding_l_r",element:"kaktusp-remove-btn",cssOption:"padding-left",cssType:"size"},"kaktusp-remove-btn-padding-right":{data:"product",value:"remove_btn_padding_l_r",element:"kaktusp-remove-btn",cssOption:"padding-right",cssType:"size"},"kaktusp-cart-border-width":{data:"product",value:"prod_border_width",input:"kaktusp-cart-border-size",element:"kaktusp-product-border",cssOption:"border-width",cssType:"size"},"kaktusp-cart-border-color":{data:"product",value:"prod_border_color",input:"kaktusp-cart-border-color",element:"kaktusp-product-border",cssOption:"border-color"},"kaktusp-cart-border-radius":{data:"product",value:"prod_border_radius",input:"kaktusp-cart-border-radius",element:"kaktusp-product-border",cssOption:"border-radius",cssType:"size"},"kaktusp-prod-title-color":{data:"product",value:"prod_title_color",input:"kaktusp-prod-title-color",element:"kaktusp-prod-title",cssOption:"color"},"kaktusp-prod-title-font-size":{data:"product",value:"prod_title_font_size",input:"kaktusp-prod-title-font-size",element:"kaktusp-prod-title",cssOption:"font-size",cssType:"size"},"kaktusp-prod-title-font-weight":{data:"product",value:"prod_title_font_weight",input:"kaktusp-prod-title-font-weight",element:"kaktusp-prod-title",cssOption:"font-weight"},"kaktusp-prod-title-font-style":{data:"product",value:"prod_title_font_style",input:"kaktusp-prod-title-font-style",element:"kaktusp-prod-title",cssOption:"font-style"},"kaktusp-prod-title-line-height":{data:"product",value:"prod_title_line_height",input:"kaktusp-prod-title-line-height",element:"kaktusp-prod-title",cssOption:"line-height",cssType:"size"},"kaktusp-prod-desc-color":{data:"product",value:"prod_desc_color",input:"kaktusp-prod-desc-color",element:"kaktusp-prod-desc",cssOption:"color"},"kaktusp-prod-desc-font-size":{data:"product",value:"prod_desc_font_size",input:"kaktusp-prod-desc-font-size",element:"kaktusp-prod-desc",cssOption:"font-size",cssType:"size"},"kaktusp-prod-desc-font-weight":{data:"product",value:"prod_desc_font_weight",input:"kaktusp-prod-desc-font-weight",element:"kaktusp-prod-desc",cssOption:"font-weight"},"kaktusp-prod-desc-font-style":{data:"product",value:"prod_desc_font_style",input:"kaktusp-prod-desc-font-style",element:"kaktusp-prod-desc",cssOption:"font-style"},"kaktusp-prod-desc-line-height":{data:"product",value:"prod_desc_line_height",input:"kaktusp-prod-desc-line-height",element:"kaktusp-prod-desc",cssOption:"line-height",cssType:"size"},"kaktusp-qty-background":{data:"product",value:"qty_background",input:"kaktusp-qty-bg",element:"kaktusp-qty-input",cssOption:"background"},"kaktusp-qty-border":{data:"product",value:"qty_btn_bg",input:"kaktusp-qty-btn-bg",element:"kaktusp-qty-input",cssOption:"border-color"},"kaktusp-qty-color":{data:"product",value:"qty_font_color",input:"kaktusp-qty-color",element:"kaktusp-qty-input",cssOption:"color"},"kaktusp-qty-border-radius-top":{data:"product",value:"qty_border_radius",input:"kaktusp-qty-border-radius",element:"kaktusp-qty-input",cssOption:"border-top-left-radius",cssType:"size"},"kaktusp-qty-border-radius-bottom":{data:"product",value:"qty_border_radius",input:"kaktusp-qty-border-radius",element:"kaktusp-qty-input",cssOption:"border-bottom-left-radius",cssType:"size"},"kaktusp-qty-border-radius-btn-top":{data:"product",value:"qty_border_radius",input:"kaktusp-qty-border-radius",element:"kaktusp-qty-btn-t",cssOption:"border-top-right-radius",cssType:"size"},"kaktusp-qty-border-radius-btn-bottom":{data:"product",value:"qty_border_radius",input:"kaktusp-qty-border-radius",element:"kaktusp-qty-btn-b",cssOption:"border-bottom-right-radius",cssType:"size"},"kaktusp-price-color":{data:"product",value:"price_color",input:"kaktusp-price-color",element:"kaktusp-price",cssOption:"color"},"kaktusp-price-font-size":{data:"product",value:"price_font_size",input:"kaktusp-price-font-size",element:"kaktusp-price",cssOption:"font-size",cssType:"size"},"kaktusp-price-font-weight":{data:"product",value:"price_font_weight",input:"kaktusp-price-font-weight",element:"kaktusp-price",cssOption:"font-weight"},"kaktusp-price-font-style":{data:"product",value:"price_font_style",input:"kaktusp-price-font-style",element:"kaktusp-price",cssOption:"font-style"},"kaktusp-price-line-height":{data:"product",value:"price_line_height",input:"kaktusp-price-line-height",element:"kaktusp-price",cssOption:"line-height",cssType:"size"},"kaktusp-compare-price-color":{data:"product",value:"compare_price_color",input:"kaktusp-compare-price-color",element:"kaktusp-compare-price",cssOption:"color"},"kaktusp-compare-price-font-size":{data:"product",value:"compare_price_font_size",input:"kaktusp-compare-price-font-size",element:"kaktusp-compare-price",cssOption:"font-size",cssType:"size"},"kaktusp-compare-price-font-weight":{data:"product",value:"compare_price_font_weight",input:"kaktusp-compare-price-font-weight",element:"kaktusp-compare-price",cssOption:"font-weight"},"kaktusp-compare-price-font-style":{data:"product",value:"compare_price_font_style",input:"kaktusp-compare-price-font-style",element:"kaktusp-compare-price",cssOption:"font-style"},"kaktusp-compare-price-line-height":{data:"product",value:"compare_price_line_height",input:"kaktusp-compare-price-line-height",element:"kaktusp-compare-price",cssOption:"line-height",cssType:"size"},"kaktusp-save-background-color":{data:"product",value:"save_bg",input:"kaktusp-save-bg",element:"kaktusp-save-label",cssOption:"background"},"kaktusp-save-border-radius":{data:"product",value:"save_border_radius",input:"kaktusp-save-border-radius",element:"kaktusp-save-label",cssOption:"border-radius",cssType:"size"},"kaktusp-save-color":{data:"product",value:"save_color",input:"kaktusp-save-color",element:"kaktusp-save-label",cssOption:"color"},"kaktusp-save-font-size":{data:"product",value:"save_font_size",input:"kaktusp-save-font-size",element:"kaktusp-save-label",cssOption:"font-size",cssType:"size"},"kaktusp-save-font-weight":{data:"product",value:"save_font_weight",input:"kaktusp-save-font-weight",element:"kaktusp-save-label",cssOption:"font-weight"},"kaktusp-save-font-style":{data:"product",value:"save_font_style",input:"kaktusp-save-font-style",element:"kaktusp-save-label",cssOption:"font-style"},"kaktusp-save-line-height":{data:"product",value:"save_line_height",input:"kaktusp-save-line-height",element:"kaktusp-save-label",cssOption:"line-height",cssType:"size"},"kaktusp-save-padding":{data:"product",value:"save_padding",input:"kaktusp-save-padding",element:"kaktusp-save-label",cssOption:"padding",cssType:"size"},"kaktusp-variations-bg":{data:"product",value:"variations_background",input:"kaktusp-variations-bg",element:"kaktusp-variations",cssOption:"background-color"},"kaktusp-variations-color":{data:"product",value:"variations_font_color",input:"kaktusp-variations-color",element:"kaktusp-variations",cssOption:"color"},"kaktusp-variations-border-widrh":{data:"product",value:"variations_border_width",input:"kaktusp-variations-border-size",element:"kaktusp-variations",cssOption:"border-width",cssType:"size"},"kaktusp-variations-border-color":{data:"product",value:"variations_border_color",input:"kaktusp-variations-border-color",element:"kaktusp-variations",cssOption:"border-color",},"kaktusp-variations-border-radius":{data:"product",value:"variations_border_radius",input:"kaktusp-variations-border-radius",element:"kaktusp-variations",cssOption:"border-radius",cssType:"size"},"kaktusp-discount-text-color":{data:"product",value:"discount_text_color",element:"kaktusp-discount-text",cssOption:"color"},"kaktusp-discount-text-font-size":{data:"product",value:"discount_text_font_size",element:"kaktusp-discount-text",cssOption:"font-size",cssType:"size"},"kaktusp-discount-text-font-weight":{data:"product",value:"discount_text_font_weight",element:"kaktusp-discount-text",cssOption:"font-weight"},"kaktusp-discount-text-font-style":{data:"product",value:"discount_text_font_style",element:"kaktusp-discount-text",cssOption:"font-style"},"kaktusp-discount-text-line-height":{data:"product",value:"discount_text_line_height",element:"kaktusp-discount-text",cssOption:"line-height",cssType:"size"},"kaktusp-radio-bg":{data:"product",value:"radio_btn_bg",element:"kaktusp-radio-bg",cssOption:"background-color"},"kaktusp-radio-border":{data:"product",value:"radio_btn_bg",element:"kaktusp-radio-border",cssOption:"border-color"},"kaktusp-border-active":{data:"product",value:"active_background",element:"kaktusp-bg-active",cssOption:"border-color"}};const dataShowHide={"kaktusp-close":{data:"top",value:"close_show",input:"kaktusp-close-show",element:"kaktusp-close"},"kaktusp-alert-text":{data:"top",value:"alert_text_show",input:"kaktusp-alert-text-show",element:"kaktusp-alert-text"},"kaktusp-alert-prod":{data:"top",value:"alert_prod_show",input:"kaktusp-alert-prod-show",element:"kaktusp-alert-prod"},"kaktusp-alert-prod-img":{data:"top",value:"alert_prod_show",input:"kaktusp-alert-prod-show",element:"kaktusp-popup__cart-alert--img"},"kaktusp-timer":{data:"main",value:"timer_show",input:"kaktusp-timer-show",element:"kaktusp-timer"},"kaktusp-title":{data:"main",value:"title_show",input:"kaktusp-title-show",element:"kaktusp-title"},"kaktusp-description":{data:"main",value:"description_show",input:"kaktusp-description-show",element:"kaktusp-description"},"kaktusp-total":{data:"main",value:"total_show",input:"kaktusp-total-show",element:"kaktusp-total"},"kaktusp-total-price":{data:"main",value:"total_price_show",input:"kaktusp-total-price-show",element:"kaktusp-total-price"},"kaktusp-reject-btn":{data:"bottom",value:"reject_btn_show",input:"kaktusp-reject-btn-show",element:"kaktusp-reject-btn"},"kaktusp-checkout-btn":{data:"bottom",value:"checkout_btn_show",input:"kaktusp-checkout-btn-show",element:"kaktusp-checkout-btn"},"kaktusp-prod-title":{data:"product",value:"prod_title_show",input:"kaktusp-prod-title-show",element:"kaktusp-prod-title"},"kaktusp-prod-desc":{data:"product",value:"prod_desc_show",input:"kaktusp-prod-desc-show",element:"kaktusp-prod-desc"},"kaktusp-price":{data:"product",value:"price_show",input:"kaktusp-price-show",element:"kaktusp-price"},"kaktusp-compare-price":{data:"product",value:"compare_price_show",input:"kaktusp-compare-price-show",element:"kaktusp-compare-price"},"kaktusp-save":{data:"product",value:"save_show",input:"kaktusp-save-show",element:"kaktusp-save-label"},"kaktusp-qty":{data:"product",value:"qty_show",input:"kaktusp-qty-show",element:"kaktusp-qty"},"kaktusp-variations":{data:"product",value:"variations_show",input:"kaktusp-variations-show",element:"kaktusp-variations-wrap"},"kaktusp-top-show":{data:"top",value:"top_show",input:"kaktusp-top-show",element:"kaktusp-bg-top"},"kaktusp-discount-text-show":{data:"product",value:"discount_text_show",element:"kaktusp-discount-text"}};function fillWidget(widgetJson,rootId,countDownTimer){const cartBtnText=getAppSelectorAll('.kaktusp-cart-btn-text',rootId);const cartBtnTextAdded=getAppSelectorAll('.kaktusp-cart-btn-added-text',rootId);const cartBtn=getAppSelectorAll('.kaktusp-cart-btn',rootId);const beforeAlert=getAppSelector('.kaktusp-before-alert',rootId);const type=widgetJson.widget_type;switch(type){case offerTypes.crossSell:case offerTypes.postPurchase:case offerTypes.discount:case offerTypes.exitIntent:case offerTypes.cartPage:case offerTypes.beforeCheckout:case offerTypes.homePage:cartBtnText.forEach((element)=>element.classList.remove(`kaktusp-cart-btn-text-upsell`));cartBtnTextAdded.forEach((element)=>element.classList.remove(`kaktusp-cart-btn-added-text-upsell`));cartBtn.forEach((element)=>element.setAttribute('data-cart','add'));if(beforeAlert){beforeAlert.classList.remove(`kaktusp-alert-upsell`);}
break;case offerTypes.upsell:cartBtnText.forEach((element)=>element.classList.add(`kaktusp-cart-btn-text-upsell`));cartBtnTextAdded.forEach((element)=>element.classList.add(`kaktusp-cart-btn-added-text-upsell`));cartBtn.forEach((element)=>element.setAttribute('data-cart','replace'));if(beforeAlert){beforeAlert.classList.add(`kaktusp-alert-upsell`);}
break;}
getObjJsonKeys(rootId,widgetJson,dataJsonTranslation,"translation");getObjJsonKeys(rootId,widgetJson,dataJsonMainSection);getObjJsonKeys(rootId,widgetJson,dataJsonBottomSection);getObjJsonKeys(rootId,widgetJson,dataJsonProductStyle);getObjJsonKeys(rootId,widgetJson,dataJsonBtnStyle,"btn");getObjJsonKeys(rootId,widgetJson,dataShowHide,"show");const timerShow=widgetJson.main.timer_show;if(timerShow){countDownTimer.startTimer();}
const wallpaper=widgetJson.main.wallpaper;const wallpaperDiv=getAppSelector('.kaktusp-wallpaper',rootId);let wallpaperVal;if(wallpaper==='wallpaper_0'){wallpaperVal='transparent';}else{const coverWallpaper=['wallpaper_20','wallpaper_21','wallpaper_22','wallpaper_23','wallpaper_24','wallpaper_25','wallpaper_26'];if(coverWallpaper.includes(wallpaper)){wallpaperDiv.classList.add('cover');}else{wallpaperDiv.classList.remove('cover');}
wallpaperVal=`url("${kaktuspbaseUrl}assets/images/widgets/wallpapers/${wallpaper}.png")`;}
wallpaperDiv.style.background=wallpaperVal;const custom_css=widgetJson.custom_css;const customCssDiv=getAppSelector('#kaktusp-custom-css',rootId);if(custom_css){customCssDiv.innerText=custom_css.replace(/.kaktusp-/g,`#${rootId} .kaktusp-`);}else{customCssDiv.innerText='';}
const prodDesc=getAppSelectorAll('.kaktusp-desc-short',rootId);prodDesc.forEach((element)=>{let str=element.innerText.trim();if(str.length>100){let trimmedStr=str.substring(0,100)+"...";element.innerText=trimmedStr;}});}
function fillWidgetFunnel(data,rootId,offerId,countDownTimer){const cartBtnText=getAppSelectorAll('.kaktusp-cart-btn-text',rootId);const cartBtnTextAdded=getAppSelectorAll('.kaktusp-cart-btn-added-text',rootId);const cartBtn=getAppSelectorAll('.kaktusp-cart-btn',rootId);const beforeAlert=getAppSelector('.kaktusp-before-alert',rootId);const productWrapp=getAppSelector('.kaktusp-product__wrapp',rootId);const productItem=getAppSelectorAll('.kaktusp-product__item',rootId);const widgetJson=data,layout=widgetJson.design_type.layout,layout_col=widgetJson.design_type.layout_col;const type=widgetJson.widget_type;switch(type){case offerTypes.crossSell:case offerTypes.postPurchase:case offerTypes.discount:case offerTypes.exitIntent:case offerTypes.cartPage:case offerTypes.beforeCheckout:case offerTypes.homePage:cartBtnText.forEach((element)=>element.classList.remove(`kaktusp-cart-btn-text-upsell`));cartBtnTextAdded.forEach((element)=>element.classList.remove(`kaktusp-cart-btn-added-text-upsell`));cartBtn.forEach((element)=>element.setAttribute('data-cart','add'));if(beforeAlert){beforeAlert.classList.remove(`kaktusp-alert-upsell`);}
break;case offerTypes.upsell:cartBtnText.forEach((element)=>element.classList.add(`kaktusp-cart-btn-text-upsell`));cartBtnTextAdded.forEach((element)=>element.classList.add(`kaktusp-cart-btn-added-text-upsell`));cartBtn.forEach((element)=>element.setAttribute('data-cart','replace'));if(beforeAlert){beforeAlert.classList.add(`kaktusp-alert-upsell`);}
break;}
getObjJsonKeys(rootId,widgetJson,dataJsonTranslation,"translation");getObjJsonKeys(rootId,widgetJson,dataJsonProductStyle);getObjJsonKeys(rootId,widgetJson,dataJsonBtnStyle,"btn");getObjJsonKeys(rootId,widgetJson,dataShowHide,"show");setProductDescription(rootId,widgetJson)
const timerShow=widgetJson.main.timer_show;const timerMin=widgetJson.main.timer_min;const timerSeconds=widgetJson.main.timer_sec;const display=getAppSelector('.kaktusp-countdown__time',rootId);buildTimer(timerMin,timerSeconds,display);countDownTimer.stopTimer();if(timerShow){countDownTimer.reStartTimer(display,timerMin,timerSeconds,rootId,offerId);}
if(widgetJson.widget_type!=offerTypes.slider){productWrapp.classList.remove('kaktusp-product--grid','kaktusp-product--list','kaktusp-product--metro','kaktusp-grid-item-2','kaktusp-grid-item-3','kaktusp-grid-item-4');productItem.forEach((element)=>element.classList.remove('kaktusp-product__item--grid','kaktusp-product__item--list','kaktusp-product__item--metro'));if(layout){productWrapp.classList.add(`kaktusp-product--${layout}`,`kaktusp-${layout_col}`);productItem.forEach((element)=>element.classList.add(`kaktusp-product__item--${layout}`));}else{productWrapp.classList.add('kaktusp-product--grid','kaktusp-grid-item-2');productItem.forEach((element)=>element.classList.add(`kaktusp-product__item--grid`));}}
const prodDesc=getAppSelectorAll('.kaktusp-desc-short',rootId);prodDesc.forEach((element)=>{let str=element.innerText.trim();if(str.length>100){let trimmedStr=str.substring(0,100)+"...";element.innerText=trimmedStr;}});}
function fillWidgetSettings(widgetJson,rootId){const kaktuspPopup=getAppSelector('.kaktusp-popup',rootId);const kaktuspWrap=getAppSelector('.kaktusp-popup__wrap',rootId);const kaktuspBody=getAppSelector('.kaktusp-popup__body',rootId);const productWrapp=getAppSelector('.kaktusp-product__wrapp',rootId);const position=widgetJson.design_type.position,animation=widgetJson.design_type.animation,layout=widgetJson.design_type.layout,layout_col=widgetJson.design_type.layout_col?widgetJson.design_type.layout_col:'grid-item-2',widgetWidth=widgetJson.design_type.widget_width;if(widgetJson.widget_type!=offerTypes.volumeDiscount){if(kaktuspPopup){kaktuspPopup.classList.remove('kaktusp-popup__position--full','kaktusp-popup__position--right_bottom','kaktusp-popup__position--left_bottom','kaktusp-popup__position--bottom','kaktusp-popup__position--top','kaktusp-popup__position--center');kaktuspPopup.classList.add(`kaktusp-popup__position--${position}`);kaktuspPopup.classList.remove("kaktusp-hide");kaktuspWrap.setAttribute('class','kaktusp-popup__wrap');kaktuspWrap.classList.add(`animate__animated`,`${animation}`);}}
if(widgetJson.widget_type!=offerTypes.slider){if(widgetJson.widget_type!=offerTypes.volumeDiscount){productWrapp.classList.remove('kaktusp-product--grid','kaktusp-product--list','kaktusp-product--metro','kaktusp-grid-item-2','kaktusp-grid-item-3','kaktusp-grid-item-4');const productItem=getAppSelectorAll('.kaktusp-product__item',rootId);productItem.forEach((element)=>element.classList.remove('kaktusp-product__item--grid','kaktusp-product__item--list','kaktusp-product__item--metro'));if(layout){productWrapp.classList.add(`kaktusp-product--${layout}`,`kaktusp-${layout_col}`);productItem.forEach((element)=>element.classList.add(`kaktusp-product__item--${layout}`));}else{productWrapp.classList.add('kaktusp-product--grid','kaktusp-grid-item-2');productItem.forEach((element)=>element.classList.add(`kaktusp-product__item--grid`));}}
kaktuspBody.classList.remove('kaktusp-width-container','kaktusp-width-full');kaktuspBody.classList.add(`kaktusp-width-${widgetWidth}`);}}
function getObjJsonKeys(rootId,widgetJson,obj,type){for(let key in obj){if(type==="show"){setShowHide(rootId,widgetJson,obj[key].data,obj[key].value,obj[key].element);}else if(type==="translation"){setJsonTranslation(rootId,widgetJson,obj[key].data,obj[key].value,obj[key].element);}else if(type==="btn"){setJsonDataBtn(rootId,widgetJson,obj[key].data,obj[key].value,obj[key].secondValue,obj[key].element,obj[key].cssOption);}else{setJsonData(rootId,widgetJson,obj[key].data,obj[key].value,obj[key].element,obj[key].cssOption,obj[key].cssType);}}}
function setJsonTranslation(rootId,widgetJson,obj,value,element){if(!widgetJson[obj])return;const option=widgetJson[obj][value];if(option==null)return;const elements=getAppSelectorAll('.'+element,rootId);elements.forEach((element)=>{element.innerText=option;})}
function setJsonData(rootId,widgetJson,obj,value,element,styleOpt,type){if(!widgetJson[obj])return;const option=widgetJson[obj][value];let inputOption=option;if(option==null)return;if(styleOpt==="border-top-right-radius"&&element===".kaktusp-bg-top"&&inputOption!=0){inputOption=+inputOption+3;}
if(type==="size"){inputOption=inputOption+'px';}
const elements=getAppSelectorAll('.'+element,rootId);elements.forEach((element)=>{element.style[styleOpt]=inputOption;})}
function setJsonDataBtn(rootId,widgetJson,obj,value,value_2,element,styleOpt){if(!widgetJson[obj])return;const option=widgetJson[obj][value];const option_2=widgetJson[obj][value_2];let btn;if(option==null)return;let inputOption=option;btn=inputOption;let inputOption_2=option_2;const elements=getAppSelectorAll('.'+element,rootId);elements.forEach((element)=>{element.style[styleOpt]=inputOption;element.addEventListener("mouseover",function(){this.style[styleOpt]=inputOption_2;},false);element.addEventListener("mouseout",function(){this.style[styleOpt]=btn;},false);})}
function setShowHide(rootId,widgetJson,obj,value,element){if(!widgetJson[obj])return;const option=widgetJson[obj][value];if(option==null)return;const elements=getAppSelectorAll('.'+element,rootId);elements.forEach((element)=>{if(option){element.classList.remove('kaktusp-hide');}else{element.classList.add('kaktusp-hide');}})}
function setProductDescription(rootId,widgetJson){const option=widgetJson['product']['prod_desc_show_full'];if(option==null)return;const shortDescription=getAppSelectorAll('.kaktusp-desc-short',rootId);const fullDescription=getAppSelectorAll('.kaktusp-desc-full',rootId);shortDescription.forEach((element)=>{if(option){element.classList.add('kaktusp-hide');}else{element.classList.remove('kaktusp-hide');}})
fullDescription.forEach((element)=>{if(option){element.classList.remove('kaktusp-hide');}else{element.classList.add('kaktusp-hide');}})}
class Timer{constructor(data){this.element=data.display;this.minutes=parseInt(data.minutes);this.seconds=parseInt(data.seconds);this.rootId=data.rootId;this.mainOfferId=data.mainOfferId;this.offerId=data.offerId;this.offerObj=null
this.pageReload=false;this.currentTriggerType=0;if(data.offerObj){this.offerObj=data.offerObj;this.pageReload=data.offerObj.pageReload||false;this.currentTriggerType=data.offerObj.currentTriggerType||0;}
this.counter=null;}
startTimer(){this.counter=setInterval(()=>{if(+this.seconds===0){if(+this.minutes===0){this.stopTimer()
removeAppContainer(this.rootId);sendStatistic(this.mainOfferId,this.offerId);statisticArr.length=0;if(this.currentTriggerType===triggerTypes.buyItNow||this.currentTriggerType===triggerTypes.beforeCheckout){setTimeout(()=>{createOrder();},1000);}else if(this.pageReload){setTimeout(()=>{cartReload(this.offerObj);},1000);}}else{this.minutes--;this.seconds=59;}}
this.seconds=this.seconds<10?'0'+ +this.seconds:this.seconds;this.minutes=this.minutes<10?'0'+ +this.minutes:this.minutes;this.element.innerText=this.minutes+":"+this.seconds;this.seconds--;},1000);}
reStartTimer(element,minutes,seconds,rootId){this.element=element;this.minutes=parseInt(minutes);this.seconds=parseInt(seconds);this.rootId=rootId;this.stopTimer();this.startTimer();}
stopTimer(){clearInterval(this.counter);}}
function buildTimer(minutes,seconds,display){display.innerHTML="";minutes=parseInt(minutes);seconds=parseInt(seconds);seconds=seconds<10?"0"+seconds:seconds;minutes=minutes<10?"0"+minutes:minutes;display.innerText=minutes+":"+seconds;}
function restartTimer(rootId,countDownTimer){let isTimerDeactive=getAppSelector('.kaktusp-timer',rootId).classList.contains('kaktusp-hide');if(isTimerDeactive)return;const display=getAppSelector('.kaktusp-countdown__time',rootId);const timerMin=display.innerText.split(':')[0];const timerSeconds=display.innerText.split(':')[1];countDownTimer.reStartTimer(display,timerMin,timerSeconds,rootId);}
async function fetchCart(){const options={method:'GET',headers:{"Content-Type":"application/json","Accept":"application/json"}};const resp=await fetch("/cart.json",options);return await resp.json();}
async function fetchProductJSON(url){const options={method:'GET',headers:{"Content-Type":"application/json","Accept":"application/json"}};const resp=await fetch(url,options);return await resp.json();}
async function addItem(variantId,quantity,properties={}){const options={method:'POST',headers:{"Content-Type":"application/json","Accept":"application/json"},body:JSON.stringify({id:variantId,quantity:+quantity,properties:properties})};const url="/cart/add.json";const resp=await fetch(url,options);return await resp.json();}
async function removeItem(data){const options={method:'POST',headers:{"Content-Type":"application/json","Accept":"application/json"},body:JSON.stringify({...data,quantity:0})};const url="/cart/change.js";const resp=await fetch(url,options);return await resp.json();}
function removeItemById(id){return removeItem({id:`${id}`});}
function removeItemByLine(oneBasedLineIndex){return removeItem({line:oneBasedLineIndex});}
async function updateItem(data){const options={method:'POST',headers:{"Content-Type":"application/json","Accept":"application/json"},body:JSON.stringify(data)};const url="/cart/change.js";const resp=await fetch(url,options);return await resp.json();}
function updateItemByLine(oneBasedLineIndex,newQuantity,newProperties={}){return updateItem({line:oneBasedLineIndex,quantity:newQuantity,properties:newProperties});}
async function fetchPage(url){const options={method:'GET',headers:{"Content-Type":"application/json","Accept":"application/json"}};const resp=await fetch(`${url}.json`,options);return await resp.json();}
async function fetchProduct(handle){const options={method:'GET',headers:{"Content-Type":"application/json","Accept":"application/json"}};const resp=await fetch(`/products/${handle}.json`,options);return resp.json();}
function setOfferFetchUrl(offerParams,url){const domain=kaktuspShop;const product_id=offerParams.productId?`&product_id=${offerParams.productId}`:'';const variants_id=offerParams.variantsId?`&variants_id=${offerParams.variantsId}`:'';const trigger_event=offerParams.triggerType;const display_on_device=window.innerWidth>991?'3':'2';const cart_value=offerParams.cartValue?offerParams.cartValue:0;const page_id=trigger_event==='4'?`&page_select=${offerParams.targetCode}`:'';const button_code=trigger_event==='5'?`&button_code=${encodeURIComponent(offerParams.targetCode)}`:'';let logged_user="0";if(typeof ShopifyAnalytics!=="undefined"){logged_user=ShopifyAnalytics.meta.page.customerId?'1':'0';}
const exclude_offers=excludeOffers.length?`&exclude_offers=${excludeOffers.join(',')}`:'';const cart=offerParams.cart?offerParams.cart:0;let kaktuspUrl=getCookie('kaktuspUrl');let parameter='';if(kaktuspUrl){parameter=kaktuspUrl;}
const url_parameter=parameter?`&url_parameter=${encodeURIComponent(parameter)}`:'';return kaktuspApiUrl+`${url}?domain=${domain}${product_id}${variants_id}&cart=${cart}&trigger_event=${trigger_event}&display_on_device=${display_on_device}&cart_value=${cart_value}&logged_user=${logged_user}${page_id}${button_code}${url_parameter}${exclude_offers}`;}
async function offerFetch(offerParams){getExcludeCartOffer();const options={headers:{'Content-Type':'application/json',"Accept":"application/json"}};let url=setOfferFetchUrl(offerParams,'api/front/offers');const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.json();}
async function offerVolumeDiscountFetch(offerParams){getExcludeCartOffer();const options={headers:{'Content-Type':'application/json',"Accept":"application/json"}};const url=setOfferFetchUrl(offerParams,'api/front/volume-discount');const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.json();}
async function offerFetchPrewiev(offerParams){getExcludeCartOffer();const options={headers:{'Content-Type':'application/json',"Accept":"application/json"}};const domain=kaktuspShop;const product_id=offerParams.productId?`&product_id=${offerParams.productId}`:'';const params=new URLSearchParams(window.location.search)
const main_offer_id=params.get('offerId');let url=kaktuspApiUrl+`api/front/offers/popup-data?domain=${domain}${product_id}&main_offer_id=${main_offer_id}`;const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.json();}
async function createStatisticFetch(main_offer_id,offer_id,addedToCart,funnelViews){const options={method:'POST',headers:{'Content-Type':'application/json',"Accept":"application/json"},body:JSON.stringify(createStatisticRequest(main_offer_id,offer_id,addedToCart,funnelViews))};let url=kaktuspApiUrl+`api/front/statistic`;const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.text();}
function createStatisticRequest(main_offer_id,offer_id,addedToCart,views){const domain=kaktuspShop;const action=addedToCart?'accept':'decline';return{domain:domain,main_offer_id:main_offer_id,offer_id:offer_id,action:action,views:views}}
function sendStatistic(mainOfferId,offerId,funnelAction=false){if(statisticArr.includes(offerId)){const offerIdsArr=statisticArr.filter(element=>element===offerId);let funnelViews;if(funnelAction){funnelViews=offerIdsArr.length>1?0:1;}else{funnelViews=offerIdsArr.length>=1?0:1;}
createStatisticFetch(mainOfferId,offerId,funnelAction,funnelViews);}else{createStatisticFetch(mainOfferId,offerId,funnelAction,1);}}
async function createPurchaseFetch(data){const options={method:'POST',headers:{'Content-Type':'application/json',"Accept":"application/json"},body:JSON.stringify(createPurchaseRequest(data))};let url=kaktuspApiUrl+`api/front/purchase`;const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.text();}
function createPurchaseRequest(data){const domain=kaktuspShop;const main_offer_id=data.main_offer_id;const amount=[];data.offer_amount.forEach(item=>{amount.push({offer_id:item.offer_id,amount:item.amount})});return{domain:domain,main_offer_id:main_offer_id,offer_amount:amount}}
function createPurchaseData(mainOfferId,offerId,variantId,propertyId,storePrice){const localOfferData=localStorage.getItem('kaktuspPurchaseData');purchaseData=localOfferData?JSON.parse(localOfferData):purchaseData;let offerData={'main_offer_id':mainOfferId,'offer':[]}
if(purchaseData.length){const checkMainOfferId=purchaseData.find(item=>item.main_offer_id===mainOfferId);if(checkMainOfferId){setOfferData(checkMainOfferId);}else{purchaseData.push(offerData);setOfferData(offerData);}}else{purchaseData.push(offerData)
setOfferData(offerData);}
function setOfferData(data){data.offer.push({offer_id:offerId,product_id:variantId,property_id:propertyId,product_store_price:storePrice})}
localStorage.setItem('kaktuspPurchaseData',JSON.stringify(purchaseData));}
const s_ajaxListener=new Object();s_ajaxListener.tempOpen=XMLHttpRequest.prototype.open;s_ajaxListener.tempSend=XMLHttpRequest.prototype.send;s_ajaxListener.callback=function(){let thisUrl=this.url.replace(/\?(.+)/ig,"");if(thisUrl==="/cart/add.js"||thisUrl==="/cart/add.json"||thisUrl==="/cart/add"){const triggerType=triggerTypes.addToCart;let dataStr,variantsId;if(typeof(this.data)==='object'){if(this.data instanceof FormData){for(let pair of this.data.entries()){if(pair[0]==='id'){variantsId=pair[1];}}}}else if(typeof(this.data)==='string'){if(this.data.includes('&')){dataStr=this.data.split('&');dataStr.forEach(element=>{if(element.includes('id=')){variantsId=element.split('=');variantsId=variantsId[variantsId.length-1];}});}else if(this.data.includes('{')){dataStr=JSON.parse(this.data);variantsId=dataStr.id?dataStr.id:dataStr.items[0].id;}}
currentProductId=variantsId;if(volumeOffer){addToCartVolume(variantsId);}
if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){if(location.href.includes('/products/')){addToCartProductPage(triggerType,variantsId,currentProductId);}else{addToCartTrigger(triggerType,variantsId,currentProductId);}}}
if(thisUrl==="/cart/change.js"||thisUrl==="/cart/change.json"||thisUrl==="/cart/change"){setTimeout(()=>{checkVolumeProducts();setTimeout(()=>{},1000);},500);}}
XMLHttpRequest.prototype.open=function(a,b){if(!a)var a='';if(!b)var b='';s_ajaxListener.tempOpen.apply(this,arguments);s_ajaxListener.method=a;s_ajaxListener.url=b;if(a.toLowerCase()=='get'){s_ajaxListener.data=b.split('?');s_ajaxListener.data=s_ajaxListener.data[1];}}
XMLHttpRequest.prototype.send=function(a,b){if(!a)var a='';if(!b)var b='';s_ajaxListener.tempSend.apply(this,arguments);if(s_ajaxListener.method.toLowerCase()=='post')s_ajaxListener.data=a;s_ajaxListener.callback();}
const nativeFetch=window.fetch;window.fetch=async function(...args){let thisUrl=args[0].replace(/\?(.+)/ig,"");if(thisUrl==="/cart/add.js"||thisUrl==="/cart/add.json"||thisUrl==="/cart/add"){if(typeof args[1].body==='string'&&(args[1].body.includes('offer')||triggerProduct)){triggerProduct=false;return nativeFetch.apply(window,args);}
let response=await nativeFetch.apply(window,args);if(response.status===200){const triggerType=triggerTypes.addToCart;let dataArgs,variantsId;if(typeof(args[1].body)==='object'&&args[1].body instanceof FormData){for(let pair of args[1].body.entries()){if(pair[0]==='id'){variantsId=pair[1];}}}else if(typeof(args[1].body)==='string'){if(args[1].body.includes('&')){dataArgs=args[1].body.split('&');dataArgs.forEach(element=>{if(element.includes('id=')){variantsId=element.split('=');variantsId=variantsId[variantsId.length-1];}});}else if(args[1].body.includes('{')){dataArgs=JSON.parse(args[1].body);variantsId=dataArgs.id?dataArgs.id:dataArgs.items[0].id;}}else{return response;}
currentProductId=variantsId;if(volumeOffer){addToCartVolume(variantsId);}
if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){if(location.href.includes('/products/')){addToCartProductPage(triggerType,variantsId,currentProductId);}else{addToCartTrigger(triggerType,variantsId,currentProductId);}}}
return response}else if(thisUrl==="/cart/change.js"||thisUrl==="/cart/change.json"||thisUrl==="/cart/change"){let response=await nativeFetch.apply(window,args);if(response.status===200){checkVolumeProducts();setTimeout(()=>{},1000);}
return response}else{return nativeFetch.apply(window,args);}}
function addToCartProductPage(triggerType,variantsId,currentProductId){let url=location.href.split('/');let productsIndex=url.indexOf('products');url=url[productsIndex+1];fetchProduct(url).then(function(dataPage){console.log(dataPage);const productId=dataPage.product.id;fetchCart().then(function(dataCart){let cart;if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();}
const offerParams={triggerType,productId,variantsId,cart,cartValue:dataCart.total_price}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}});});})}
function addToCartTrigger(triggerType,variantsId,currentProductId){fetchCart().then(function(dataCart){const targetProduct=dataCart.items.find(item=>parseInt(item.id)===parseInt(variantsId));if(!targetProduct){addToCartTrigger(triggerType,variantsId,currentProductId);return false;}
const productId=targetProduct.product_id;let cart;if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();}
const offerParams={triggerType,productId,variantsId,cart,cartValue:dataCart.total_price}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}});});}
function addToCartVolume(variantsId){fetchCart().then(dataCart=>{const targetProduct=dataCart.items.find(product=>product.variant_id===+variantsId&&(!!!product.properties||(product.properties&&!product.properties.offer)));if(targetProduct){const targetIndex=dataCart.items.findIndex(product=>product.variant_id===+variantsId&&(!!!product.properties||(product.properties&&!product.properties.offer)));let{variant_id,quantity}=targetProduct;let propertyId=makeId(5);let{volumeDataOptions,offerObj}=volumeOffer;let discountType=null;let discountValue=null;volumeDataOptions.forEach(option=>{const optionQty=option.allow_range?option.range_to:option.range_from;if(optionQty<=quantity||option.range_from<=quantity){discountType=option.discount_type;discountValue=option.discount_value;}})
updateItemByLine(targetIndex+1,quantity,{offer:propertyId}).then(()=>{createVolumeProductsData(offerObj.volumeId,variant_id,propertyId);createVolumeData(offerObj.volumeId,volumeDataOptions);});}})}
function updateProductsData(dataCart){const localProductsData=JSON.parse(localStorage.getItem('kaktuspProductsData'));if(!localProductsData)return;if(dataCart.items.length<1||localProductsData.length<1){localStorage.removeItem('kaktuspProductsData');}else{localProductsData.forEach((element,i)=>{if(element.funnelProducts.length){element.funnelProducts.forEach((funnelProduct,index)=>{const isFunnelProduct=dataCart.items.find(item=>item.properties.offer===funnelProduct.propertyId);if(!isFunnelProduct){element.funnelProducts.splice(index,1);}})}else{localProductsData.splice(i,1);}})
localStorage.setItem('kaktuspProductsData',JSON.stringify(localProductsData));}}
function removeBundleGroupDiscount(bundleSet,index,localBundleData){const localDataOrder=JSON.parse(localStorage.getItem('kaktusDataOrder'));for(let i=0;i<bundleSet.bundleProducts.length;i++){const isProduct=localDataOrder.find(item=>item.propertyId===bundleSet.bundleProducts[i].propertyId);if(isProduct){isProduct.discountType=null;isProduct.discountValue=null;}}
localBundleData.splice(index,1);localStorage.setItem('kaktusDataOrder',JSON.stringify(localDataOrder));localStorage.setItem('kaktuspBundleData',JSON.stringify(localBundleData));}
function removeBundleGroup(dataCart,bundleSet,products){for(let i=0;i<dataCart.items.length;i++){const isBundleProduct=bundleSet[products].find(item=>item.propertyId===dataCart.items[i].properties.offer);if(isBundleProduct){removeItemByLine(i+1);break;}}}
function checkVolumeProducts(){const localVolumeData=JSON.parse(localStorage.getItem('kaktuspVolumeData'));const localDataOrder=JSON.parse(localStorage.getItem('kaktusDataOrder'));if(!localVolumeData)return;fetchCart().then(dataCart=>{updateVolumeData(dataCart,localVolumeData);const updatedVolumeData=JSON.parse(localStorage.getItem('kaktuspVolumeData'));if(!updatedVolumeData)return;updatedVolumeData.forEach(volumeSet=>{let volumeOrderQty=0;let volumeCartQty=0;for(let i=0;i<volumeSet.volumeProducts.length;i++){const targetProduct=localDataOrder.find(item=>item.propertyId===volumeSet.volumeProducts[i].propertyId);if(targetProduct){volumeOrderQty+=+targetProduct.qty;}
const targetCartProduct=dataCart.items.find(item=>item.properties.offer===volumeSet.volumeProducts[i].propertyId);if(targetCartProduct){volumeCartQty+=+targetCartProduct.quantity;}}
if(+volumeOrderQty!==+volumeCartQty){let volumeDiscountArr=[];createVolumeDiscountArray(volumeDiscountArr,volumeSet,volumeCartQty);changeVolumeDiscount(dataCart,volumeDiscountArr,localDataOrder);}});});}
function createVolumeDiscountArray(volumeDiscountArr,volumeSet,volumeCartQty){let currentCartQty=volumeCartQty;let currentOption=null;volumeSet.volumeOptions.forEach(option=>{const optionQty=option.allow_range?option.range_to:option.range_from;if(optionQty<=currentCartQty||option.range_from<=currentCartQty){currentOption={qty:optionQty,discount_type:option.discount_type,discount_value:option.discount_value};}});if(currentOption===null){volumeDiscountArr.push({qty:`${currentCartQty}`,discount_type:null,discount_value:null});return false;}else{volumeDiscountArr.push(currentOption);}
currentCartQty=+currentCartQty- +currentOption.qty;if(currentCartQty<=0)return false;createVolumeDiscountArray(volumeDiscountArr,volumeSet,currentCartQty);}
function changeVolumeDiscount(dataCart,volumeDiscountArr,localDataOrder){dataCart.items.forEach(product=>{if(product.properties&&product.properties.offer){const productProperty=product.properties.offer;const productQty=product.quantity;let productPrice=+product.discounted_price / 100;let currentProductQty=productQty;let isDiscount=false;const totalPrice=productPrice*productQty;let totalDiscountedPrice=totalPrice;for(let i=0;i<volumeDiscountArr.length;i++){let discount=0;let{qty,discount_type,discount_value}=volumeDiscountArr[i];if(+qty===0){continue;}
if(+qty>=+currentProductQty){if(discount_value){if(discount_type==="%"){discount=+productPrice*+discount_value / 100;}else{discount=+discount_value;}
isDiscount=true;totalDiscountedPrice=totalDiscountedPrice-(discount*+currentProductQty);}
qty=+qty- +currentProductQty;volumeDiscountArr[i].qty=`${qty}`;break;}else{if(discount_value){if(discount_type==="%"){discount=+productPrice*+discount_value / 100;}else{discount=+discount_value;}
isDiscount=true;totalDiscountedPrice=totalDiscountedPrice-(discount*+qty);}
currentProductQty=currentProductQty- +qty;volumeDiscountArr[i].qty=`0`;}}
const result=totalPrice-totalDiscountedPrice;let currentDiscount=isDiscount?result / productQty:null;const targetOrderProduct=localDataOrder.find(item=>item.propertyId===productProperty);targetOrderProduct.qty=productQty;targetOrderProduct.discountType=`${kaktuspCurrencySymbol.includes('{{') ? currentCurrencySymbol.replace(/{{(.*?)}}/ig, '') : currentCurrencySymbol}`;targetOrderProduct.discountValue=`${currentDiscount}`;}})
localStorage.setItem('kaktusDataOrder',JSON.stringify(localDataOrder));}
function updateVolumeData(dataCart,localVolumeData){if(dataCart.items.length<1||localVolumeData.length<1){localStorage.removeItem('kaktuspVolumeData');}else{localVolumeData.forEach((volumeSet,index)=>{if(volumeSet.volumeProducts.length){for(let i=0;i<volumeSet.volumeProducts.length;i++){const isVolumeProduct=dataCart.items.find(item=>item.properties.offer===volumeSet.volumeProducts[i].propertyId);if(!isVolumeProduct){volumeSet.volumeProducts.splice(i,1);}}}else{localVolumeData.splice(index,1);}});localStorage.setItem('kaktuspVolumeData',JSON.stringify(localVolumeData));}}
if("/cart"===location.href.slice(-5)){const triggerType=triggerTypes.cartPage;if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){fetchCart().then(function(dataCart){let variantsId='0',cart='0';if(dataCart.items.length){const targetProducts=dataCart.items.filter(item=>!!!item.properties||(item.properties&&!item.properties.offer));if(targetProducts.length){variantsId=targetProducts.map(item=>item.id);variantsId=variantsId.join();}
cart=dataCart.items.map(item=>item.product_id);cart=cart.join();}
const offerParams={triggerType,variantsId,cart,cartValue:dataCart.total_price}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){if(dataCart.items.length){currentProductId=dataOffer.trigger_id!='any'?dataOffer.trigger_id:dataCart.items[0].id;buildPopUpType(dataOffer,dataCart,currentProductId,triggerType)}else{buildPopUpType(dataOffer,dataCart,false,triggerType);}}})})}}
if("/thank_you"===location.href.slice(-10)||Shopify.checkout){const triggerType=triggerTypes.thankYouPage;const orderItems=Shopify.checkout.line_items;const offerData=JSON.parse(localStorage.getItem('kaktuspPurchaseData'));const totalPrice=Math.round(parseFloat(Shopify.checkout.total_price)*100);const orderId=Shopify.checkout.order_id;orderItems.forEach(item=>{if(Object.values(item.properties)[1]==='Pre-Order'){sendOrderId(orderId)}})
let cart=orderItems.map(item=>item.product_id);cart=cart.join();let variantsId=orderItems.map(item=>item.variant_id);variantsId=variantsId.join();sendPurchaseAPI(offerData,orderItems);localStorage.removeItem('kaktusDataOrder');if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){const offerParams={triggerType,cart,variantsId,cartValue:totalPrice}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){buildPopUpType(dataOffer,false,false,triggerType);}})}}
function sendPurchaseAPI(offerData,orderItems){if(!offerData){return}
offerData.forEach(mainOfferItem=>{const offerDataItem={'main_offer_id':mainOfferItem.main_offer_id,'offer_amount':[]}
mainOfferItem.offer.forEach(offerItem=>{const lineItemProperty=orderItems.find(item=>offerItem.property_id===item.properties.offer)
if(lineItemProperty){let discount;let qty=+lineItemProperty.quantity!==0?+lineItemProperty.quantity:1;if(lineItemProperty.applied_discounts.length>0&&lineItemProperty.applied_discounts[0].amount){discount=lineItemProperty.applied_discounts[0].amount;}
if(offerDataItem.offer_amount.length){const checkOfferId=offerDataItem.offer_amount.find(item=>item.offer_id===offerItem.offer_id);if(checkOfferId){checkOfferId.amount=(+checkOfferId.amount+(discount?(+offerItem.product_store_price*qty)-discount:+offerItem.product_store_price*qty)).toFixed(2);}else{offerDataItem.offer_amount.push({offer_id:offerItem.offer_id,amount:discount?((+offerItem.product_store_price*qty)-discount).toFixed(2):(+offerItem.product_store_price*qty).toFixed(2)});}}else{offerDataItem.offer_amount.push({offer_id:offerItem.offer_id,amount:discount?((+offerItem.product_store_price*qty)-discount).toFixed(2):(+offerItem.product_store_price*qty).toFixed(2)});}}})
if(offerDataItem.offer_amount.length){createPurchaseFetch(offerDataItem);}})
localStorage.removeItem('kaktuspPurchaseData');}
if(location.href.includes('/products/')){const triggerType=triggerTypes.productPage;let url=location.href.split('/');let productsIndex=url.indexOf('products');url=url[productsIndex+1];fetchProduct(url).then(function(dataPage){const productId=dataPage.product.id;const any_products=Object.values(kaktuspTriggerProducts)[0];const productsId=Object.values(kaktuspTriggerProducts)[1];const isArr=Array.isArray(productsId);const inventory=document.getElementById('variant-inventory');if(isArr&&(any_products||productsId.includes(productId))){removeShopifyForm();}else if(!isArr&&(any_products||Object.values(productsId).includes(productId))){removeShopifyForm();};fetchCart();fetchCart().then(function(dataCart){let cart='0';if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();}
const offerParams={triggerType,productId,cart,cartValue:dataCart.total_price}
if(location.href.includes('offerId')){offerFetchPrewiev(offerParams).then(dataOffer=>{if(dataOffer.offers){currentProductId=dataPage.product.id;dataOffer.products[productId]=setTriggerProductToOffer(dataPage.product);const offerProducts=dataOffer.offers[Object.keys(dataOffer.offers)[0]].products;offerProducts.unshift(setTriggerProductIds(dataPage.product));removeShopifyForm();buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}});}else{if(isArr&&(any_products||productsId.includes(productId))){removeShopifyForm();}else if(!isArr&&(any_products||Object.values(productsId).includes(productId))){removeShopifyForm();};if(inventory){if(kaktuspFreeActiveApp==1&&!(inventory.textContent&&inventory.textContent.trim())){offerVolumeDiscountFetch(offerParams).then(dataOffer=>{if(dataOffer.offers){currentProductId=dataPage.product.id;let isProductInResp=dataOffer.products[productId];if(!isProductInResp){dataOffer.products[productId]=setTriggerProductToOffer(dataPage.product);const offerProducts=dataOffer.offers[Object.keys(dataOffer.offers)[0]].products;offerProducts.unshift(setTriggerProductIds(dataPage.product));}
buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}});}}}});})}
const exitIntent=e=>{const shouldShowExitIntent=!e.toElement&&!e.relatedTarget&&e.clientY<10;if(shouldShowExitIntent){document.removeEventListener('mouseout',exitIntent);const triggerType=triggerTypes.exitIntent;if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){fetchCart().then(function(dataCart){let cart='0',variantsId='0';if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();variantsId=dataCart.items.map(item=>item.id);variantsId=variantsId.join();}
const offerParams={triggerType,cart,variantsId,cartValue:dataCart.total_price,}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){if(dataCart.items.length){currentProductId=dataOffer.trigger_id!='any'?dataOffer.trigger_id:dataCart.items[0].id;buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}else{buildPopUpType(dataOffer,dataCart,false,triggerType);}}})})}else{return;}}};setTimeout(()=>{document.addEventListener('mouseout',exitIntent);},1000);if(document.location.pathname==="/"){const triggerType=triggerTypes.homePage;getOfferCommon(triggerType);}
if(location.href.includes('/collections/')){const triggerType=triggerTypes.collectionPage;getOfferCommon(triggerType);}
if(location.href.includes('/blogs/')){const triggerType=triggerTypes.blogPage;getOfferCommon(triggerType);}
function buyItNowTrigger(thisTarget,itemTrim,triggerType){let form=thisTarget.closest('form[action="/cart/add"]');let data=new FormData(form);let formObj=serialize(data);function serialize(data){let obj={};for(let[key,value]of data){if(obj[key]!==undefined){if(!Array.isArray(obj[key])){obj[key]=[obj[key]];}
obj[key].push(value);}else{obj[key]=value;}}
return obj;}
let variantsId=0;let qty=1;let properties='';for(let key in formObj){if(key==='id'){variantsId=formObj[key];}else if(key==='quantity'){qty=formObj[key];}else if(key.includes('properties')){if(key.includes('[')){const result=key.replace(/(.+\[)(.+)(\])/ig,'$2');properties={[result]:formObj[key]}}else{properties=formObj[key];}}}
triggerProduct=true;addItem(variantsId,qty,properties).then(function(){fetchCart().then(dataCart=>{let productId=null;let cart='0';if(dataCart.items.length){const targetProduct=dataCart.items.find(item=>!!!item.properties||(item.properties&&!item.properties.offer)&&item.id==variantsId);productId=targetProduct?targetProduct.product_id:productId;cart=dataCart.items.map(item=>item.product_id);cart=cart.join();}
const offerParams={triggerType,productId,variantsId,cart,cartValue:dataCart.total_price,targetCode:itemTrim}
offerFetch(offerParams).then(dataOffer=>{if(dataOffer.offers){if(dataCart.items.length){currentProductId=dataOffer.trigger_id!='any'?dataOffer.trigger_id:dataCart.items[0].id;buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}else{buildPopUpType(dataOffer,dataCart,false,triggerType);}}else{createOrder();}}).catch(error=>{console.error(error);createOrder();});});}).catch(error=>console.error(error));}
function getOfferCommon(triggerType){if(Object.keys(kaktuspTriggerEvents).length&&kaktuspTriggerEvents.includes(+triggerType)){fetchCart().then(function(dataCart){let cart='0',variantsId='0';if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();variantsId=dataCart.items.map(item=>item.id);variantsId=variantsId.join();}
const offerParams={triggerType,cart,variantsId,cartValue:dataCart.total_price,}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){if(dataCart.items.length){currentProductId=dataOffer.trigger_id!='any'?dataOffer.trigger_id:dataCart.items[0].id;buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}else{buildPopUpType(dataOffer,dataCart,false,triggerType);}}})})}else{return;}}
function getOfferButtons(itemTrim,triggerType){fetchCart().then(function(dataCart){let cart='0',variantsId='0';if(dataCart.items.length){cart=dataCart.items.map(item=>item.product_id);cart=cart.join();variantsId=dataCart.items.map(item=>item.id);variantsId=variantsId.join();}
const offerParams={triggerType,cart,variantsId,cartValue:dataCart.total_price,targetCode:itemTrim}
offerFetch(offerParams).then(function(dataOffer){if(dataOffer.offers){if(dataCart.items.length){currentProductId=dataOffer.trigger_id!='any'?dataOffer.trigger_id:dataCart.items[0].id;buildPopUpType(dataOffer,dataCart,currentProductId,triggerType);}else{buildPopUpType(dataOffer,dataCart,false,triggerType);}}else{if(triggerType===triggerTypes.beforeCheckout)createOrder();}}).catch(error=>{console.error(error);if(triggerType===triggerTypes.beforeCheckout)createOrder();});})}
function setTriggerProductToOffer(product){const regex=/(<([^>]+)>)/ig;const variantsObj={};for(let key in product.variants){let variantItem=product.variants[key];let variantObj={title:variantItem.title,description:product.body_html?(product.body_html).replace(regex,""):"",inventory_management:variantItem.inventory_management,productId:variantItem.id,variantPrice:kaktuspCurrencyCode!==currentCurrencyCode?getStorePriceByRate(variantItem.price):variantItem.price,}
variantsObj[variantItem.id]=variantObj;}
return{title:product.title,description:product.body_html?(product.body_html).replace(regex,""):"",inventory_management:product.variants[0].inventory_management,productId:product.id,variants:variantsObj,fbtTriggeredProduct:true}}
function setTriggerProductIds(product){const variantsArr=[];for(let key in product.variants){variantsArr.push(product.variants[key].id);}
return{[product.id]:variantsArr}}!function(){let lastBtn=null
document.addEventListener('click',function(e){if(!e.target.closest)return;lastBtn=e.target.closest('button, input[type=submit]');},true);document.addEventListener('submit',function(e){if('submitter'in e)return;var canditates=[document.activeElement,lastBtn];lastBtn=null;for(var i=0;i<canditates.length;i++){var candidate=canditates[i];if(!candidate)continue;if(!candidate.form)continue;if(!candidate.matches('button, input[type=submit]'))continue;e.submitter=candidate;return;}
e.submitter=e.target.querySelector('button, input[type=submit]')},true);}();document.addEventListener("submit",function(e){if("string"==typeof e.target.action){let actionUrl=e.target.action;if(actionUrl.includes('?')){actionUrl=actionUrl.split('?')[0];}
if("/checkout"===actionUrl.slice(-9)||"/cart"===actionUrl.slice(-5)){const btnType=e.submitter.getAttribute('name');if(btnType&&btnType==='update')return;e.preventDefault();createOrder();}}});if(!!document.querySelector('a[href="/checkout"]')){document.querySelector('a[href="/checkout"]').addEventListener('click',function(e){e.preventDefault();createOrder();})}
async function sendOrderId(orderId){let domain=(typeof kaktuspShop!=='undefined')?kaktuspShop:window.location.hostname;const options={method:'POST',headers:{"Content-Type":"application/json","Accept":"application/json"},body:JSON.stringify({order_id:orderId,domain:domain})};const url=kaktuspApiUrl+`api/front/pre-order`;const resp=await fetch(url,options);return await resp.json();}
async function createOrderFetch(dataCart,orderData){const options={method:'POST',headers:{'Content-Type':'application/json',"Accept":"application/json"},body:JSON.stringify(createOrderRequest(dataCart,orderData))};let url=kaktuspApiUrl+`api/front/draft-order`;const resp=await fetch(url,options);if(!resp.ok){throw new Error(`HTTP error, status = ${resp.status}`);}
return await resp.json();}
function createOrderRequest(dataCart,orderData){const domain=kaktuspShop;const line_items=[];let discount=null;let properties=null;dataCart.forEach(item=>{let qty=item.quantity;if(orderData){if(!!item.properties&&!!item.properties.offer){const lineItemProperty=orderData.find(prod=>prod.propertyId===item.properties.offer);if(lineItemProperty){discount=lineItemProperty.discountValue!=null?{value_type:lineItemProperty.discountType,value:+lineItemProperty.discountValue}:null;item.properties.offer=lineItemProperty.propertyId;properties=item.properties;qty=+lineItemProperty.qty;}}else{discount=null;properties=item.properties;}}
line_items.push({title:item.title,product_id:item.product_id,variant_id:item.variant_id,price:kaktuspCurrencyCode!==currentCurrencyCode?getStorePriceByRate(item.price / 1000)*1000:item.price,quantity:qty,discount:discount,properties:properties})
if(+item.quantity>+qty){let result=+item.quantity- +qty;item.properties.offer=null;line_items.push({title:item.title,product_id:item.product_id,variant_id:item.variant_id,price:kaktuspCurrencyCode!==currentCurrencyCode?getStorePriceByRate(item.price / 1000)*1000:item.price,quantity:result,discount:null,properties:item.properties})}})
return{domain:domain,line_items:line_items}}
function createOrderData(variantId,propertyId,qty){const localOrderData=localStorage.getItem('kaktusDataOrder');orderData=localOrderData?JSON.parse(localOrderData):orderData;let productData={variantId:variantId,propertyId:propertyId,discountType:null,discountValue:null,qty:qty}
orderData.push(productData);localStorage.setItem('kaktusDataOrder',JSON.stringify(orderData));}
function createOrder(){const modalBody=document.querySelector("#kaktusp-app");if(modalBody){getAppSelector('.kaktusp-popup__body').classList.add('kaktusp-preload');}
const line_items=[];fetchCart().then(function(dataCart){const orderData=JSON.parse(localStorage.getItem('kaktusDataOrder'));dataCart.items.forEach(item=>{if(orderData){if(!!item.properties&&!!item.properties.offer){const lineItemProperty=orderData.find(prod=>prod.propertyId===item.properties.offer);if(lineItemProperty){if(lineItemProperty.discountValue!=null){line_items.push(item);}}}}});if(line_items.length){createOrderFetch(dataCart.items,orderData).then(result=>{location.href=result.checkout;},error=>{location.href='/checkout';})}else{location.href='/checkout';}})}
function goToCart(){const modalBody=document.querySelector("#kaktusp-app");if(modalBody){getAppSelector('.kaktusp-popup__body').classList.add('kaktusp-preload');}
let domain=location.href.split('/');domain=domain[0]+'//'+domain[2];location.href=domain+'/cart';};function facebookPixel(){if(!facebookId){return;}else{!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init',facebookId);fbq('track','PageView');}}
function googleAnalytics(){if(!googleId){return;}else{(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create',googleId,'auto');ga('send','pageview');}}
function pinteresPixel(){if(!pinterestId){return;}else{!function(e){if(!window.pintrk){window.pintrk=function(){window.pintrk.queue.push(Array.prototype.slice.call(arguments))};var
n=window.pintrk;n.queue=[],n.version="3.0";var
t=document.createElement("script");t.async=!0,t.src=e;var
r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)}}
("https://s.pinimg.com/ct/core.js");pintrk('load',pinterestId);pintrk('page');pintrk('track','pagevisit');}}
function snapPixel(){if(!snapId){return;}else{(function(win,doc,sdk_url){if(win.snaptr)return;var tr=win.snaptr=function(){tr.handleRequest?tr.handleRequest.apply(tr,arguments):tr.queue.push(arguments);};tr.queue=[];var s='script';var new_script_section=doc.createElement(s);new_script_section.async=!0;new_script_section.src=sdk_url;var insert_pos=doc.getElementsByTagName(s)[0];insert_pos.parentNode.insertBefore(new_script_section,insert_pos);})(window,document,'https://sc-static.net/scevent.min.js');snaptr('init',snapId,{'user_email':snapEmail})
snaptr('track','PAGE_VIEW');}}
function socialPixel(){facebookPixel();googleAnalytics();pinteresPixel();snapPixel();}
function increasePopupShown(){let currentShownPerMonth=parseInt(getCookie('kaktuspCurrentShownPerMonth'));let currentShownPerDay=parseInt(getCookie('kaktuspCurrentShownPerDay'));let kaktuspStartDatePerMonth=getCookie('kaktuspStartDatePerMonth');let kaktuspStartDatePerDay=getCookie('kaktuspStartDatePerDay');currentShownPerMonth++;currentShownPerDay++;let expireMonth=new Date(Date.parse(kaktuspStartDatePerMonth)+3600000*24*25);let expireDay=new Date(Date.parse(kaktuspStartDatePerDay)+3600000*24);setCookie('kaktuspCurrentShownPerMonth',currentShownPerMonth,{expires:expireMonth});setCookie('kaktuspCurrentShownPerDay',currentShownPerDay,{expires:expireDay});}
function getExcludeCartOffer(){const offerId=localStorage.getItem(`kaktuspExcludeCartOfferId`);if(!offerId)return;excludeOffers.push(offerId);localStorage.removeItem(`kaktuspExcludeCartOfferId`);}
function cartReload(offerObj){if(offerObj.cartOfferExcludeId){localStorage.setItem(`kaktuspExcludeCartOfferId`,offerObj.cartOfferExcludeId);}
location.reload();}
class ProductPreview{constructor(product,activeProduct,rootId,countDownTimer,offerObj){this.template=this.setTemplate(product,activeProduct);this.body=document.querySelector("body");this.closeButton=this.template.querySelector('.kaktusp-product-det__close');this.qtyMinusBtn=this.template.querySelector('.kaktusp-product-det__qty--minus');this.qtyPlusBtn=this.template.querySelector('.kaktusp-product-det__qty--plus');this.qtyInput=this.template.querySelector('.kaktusp-product-det__qty--input');this.variationSelect=this.template.querySelector('.kaktusp-product-det__variations-select');this.sliderPrevBtn=this.template.querySelector('.kaktusp-product-det__prev');this.sliderNextBtn=this.template.querySelector('.kaktusp-product-det__next');this.addToCartBtn=this.template.querySelector('.kaktusp-cart-btn');this.removeBtn=this.template.querySelector('.kaktusp-remove-btn');this.activeProduct=activeProduct;this.rootId=rootId;this.countDownTimer=countDownTimer;this.maxQty=offerObj.maxQty||1;this.init();};getActiveProductData(activeProduct){const showQty=activeProduct.querySelector('.kaktusp-qty')?activeProduct.querySelector('.kaktusp-qty').classList.contains('kaktusp-hide'):true;const qtyVal=activeProduct.querySelector('.kaktusp-qty-input')?activeProduct.querySelector('.kaktusp-qty-input').value:null;const activeVariant=activeProduct.querySelector('.kaktusp-variations')?activeProduct.querySelector('.kaktusp-variations').value:null;const showButtons=activeProduct.querySelector('.kaktusp-cart-btn')?true:false;const showAddToCartBtn=showButtons?activeProduct.querySelector('.kaktusp-cart-btn').classList.contains('kaktusp-hide'):null;const addToCartBtnText=showButtons?activeProduct.querySelector('.kaktusp-cart-btn-text').innerText:null;const removeBtnText=showButtons?activeProduct.querySelector('.kaktusp-remove-btn-text').innerText:null;const addedVariants=[];if(activeProduct.querySelector('.kaktusp-variations')){const varianOptions=activeProduct.querySelectorAll('.kaktusp-variations option');varianOptions.forEach(option=>{const added=option.getAttribute('data-added');if(added==='true'){addedVariants.push(parseInt(option.value));}});}
let data={show_qty:!showQty,qty_val:qtyVal,active_variant:activeVariant,show_buttons:showButtons,is_product_added:showAddToCartBtn,add_to_cart_text:addToCartBtnText,remove_text:removeBtnText,added_variants:addedVariants}
return data;}
setTemplate(product,activeProduct){let activeProductData=this.getActiveProductData(activeProduct);let productImg=noImage;if(product.image!=undefined){productImg=`<img src="${product.image}" alt="${product.title}">`;}
let productPrice='';let comparePrice='';let minQty=product.min_quantity?product.min_quantity:1;let imagesArr=[];let variantsHtml='';if(product.variants.length>1){variantsHtml=`<select class="kaktusp-product-det__variations-select">`;for(let key in product.variants){let variantPrice=getPriceByRate(product.variants[key]['variantPrice']);if(product.discount!=undefined&&product.discount_type!=undefined&&parseInt(product.discount)!=0){variantPrice=calcVariantsDiscountPrice(product,product.variants[key]);}
let selectedOption='';if(parseInt(activeProductData.active_variant)===parseInt(product.variants[key]['productId'])){selectedOption='selected';productPrice=getPriceByRate(product.variants[key]['variantPrice']);}
let isVariantAdded=false;if((activeProductData.added_variants).includes(product.variants[key]['productId'])){isVariantAdded=true;}
variantsHtml+=`
                            <option
                                ${selectedOption}
                                value="${product.variants[key]['productId']}"
                                data-price="${getPriceByRate(product.variants[key]['variantPrice'])}"
                                data-compare-price="${getPriceByRate(product.variants[key]['variantComparePrice'])}"
                                data-diccounted-price="${variantPrice}"
                                data-variant-id="${product.variants[key]['productId']}"
                                data-added="${isVariantAdded}"
                            >
                                ${product.variants[key]['title']} - ${currencyFormat(variantPrice)}
                            </option>
                        `;if(imagesArr.length){let isAdded=imagesArr.find(item=>item.img===product.variants[key].image);if(isAdded){isAdded.ids.push(product.variants[key]['productId'])}else{imagesArr.push({img:product.variants[key].image,ids:[product.variants[key]['productId']]})}}else{imagesArr.push({img:product.variants[key].image,ids:[product.variants[key]['productId']]})}}
variantsHtml+='</select>';}else{variantsHtml='';productPrice=getPriceByRate(product.variants[0].variantPrice);}
let qtyHtml='';if(activeProductData.show_qty){qtyHtml=`
                        <div class="kaktusp-product-det__qty">
                            <div class="kaktusp-product-det__qty--minus">-</div>
                            <input class="kaktusp-product-det__qty--input" type="number" value="${activeProductData.qty_val}" min="${minQty}">
                            <div class="kaktusp-product-det__qty--plus">+</div>
                        </div>
                    `;}
if(product.discount!=undefined&&product.discount_type!=undefined&&parseInt(product.discount)!=0){let discountVal=product.discount_type!=="%"?getPriceByRate(product.discount):product.discount;comparePrice=`<span class="kaktusp-product-det__price-compare" data-discount="${discountVal}" data-discountType="${product.discount_type}">${currencyFormat(productPrice)}</span>`;if(product.discount_type==="%"){productPrice=(+productPrice-(+productPrice*+product.discount / 100));}else{productPrice=(+productPrice- +discountVal);}}
productPrice=currencyFormat(productPrice);if(imagesArr.length){if(imagesArr.length>1){let sliderImages='';imagesArr.forEach((item,i)=>{let active=item.ids.includes(parseInt(activeProductData.active_variant))?'kaktusp-slide-active':'';sliderImages+=`<div class="kaktusp-product-det__slider-item kaktusp-fade ${active}" data-image-id="${item.ids.join(',')}"><img src="${item.img}" alt="${product.title}"></div>`;});productImg=`
                            <div class="kaktusp-product-det__slider">
                                <button class="kaktusp-product-det__prev"><svg width="14px" height="14px" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M229.9 473.899l19.799-19.799c4.686-4.686 4.686-12.284 0-16.971L94.569 282H436c6.627 0 12-5.373 12-12v-28c0-6.627-5.373-12-12-12H94.569l155.13-155.13c4.686-4.686 4.686-12.284 0-16.971L229.9 38.101c-4.686-4.686-12.284-4.686-16.971 0L3.515 247.515c-4.686 4.686-4.686 12.284 0 16.971L212.929 473.9c4.686 4.686 12.284 4.686 16.971-.001z"></path></svg></button>
                                 ${sliderImages}
                                <button class="kaktusp-product-det__next"><svg fill="currentColor" width="14px" height="14px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M218.101 38.101L198.302 57.9c-4.686 4.686-4.686 12.284 0 16.971L353.432 230H12c-6.627 0-12 5.373-12 12v28c0 6.627 5.373 12 12 12h341.432l-155.13 155.13c-4.686 4.686-4.686 12.284 0 16.971l19.799 19.799c4.686 4.686 12.284 4.686 16.971 0l209.414-209.414c4.686-4.686 4.686-12.284 0-16.971L235.071 38.101c-4.686-4.687-12.284-4.687-16.97 0z"></path></svg></button>
                            </div>
                        `;}else{productImg=`<img src="${imagesArr[0].img}" alt="${product.title}">`;}}
let buttonsHtml='';if(activeProductData.show_buttons){buttonsHtml=`
                        <div class="kaktusp-product-det__btn">
                            <a href="#" class="kaktusp-cart-btn ${activeProductData.is_product_added ? 'kaktusp-hide' : ''}">
                                <svg class="kaktusp-product-icon" xmlns="http://www.w3.org/2000/svg" width="19" height="20"
                                    viewBox="0 0 19 20">
                                    <g>
                                        <g>
                                            <g>
                                                <path fill="inherit"
                                                    d="M7.126 10h-.754c-.126 0-.227-.052-.252-.138l-1.887-4.62c-.05-.12.076-.242.252-.242h1.082a.35.35 0 0 1 .276.138l1.535 4.62c.05.12-.076.242-.252.242zm9.036 1.487l2.767-6.474c.279-.651-.299-1.322-1.115-1.322H3.702L2.906.553A.74.74 0 0 0 2.209 0H.24A.229.229 0 0 0 0 .237v.987c0 .138.1.237.239.237h1.234c.12 0 .199.078.239.177l3.204 12.81a.74.74 0 0 0 .697.552h10.45c.14 0 .239-.099.239-.237v-.967c0-.138-.1-.237-.24-.237H6.37c-.1 0-.199-.079-.238-.177l-.299-1.224h9.196c.517 0 .955-.276 1.134-.671z" />
                                            </g>
                                            <g>
                                                <path fill="inherit"
                                                    d="M7.913 20c.875 0 1.584-.672 1.584-1.5S8.787 17 7.913 17c-.874 0-1.583.672-1.583 1.5S7.039 20 7.913 20z" />
                                            </g>
                                            <g>
                                                <path fill="inherit"
                                                    d="M13.193 20c.875 0 1.584-.672 1.584-1.5s-.71-1.5-1.584-1.5c-.874 0-1.583.672-1.583 1.5s.709 1.5 1.583 1.5z" />
                                            </g>
                                        </g>
                                    </g>
                                </svg>

                                <span class="kaktusp-cart-btn-text">${activeProductData.add_to_cart_text}</span>
                            </a>

                            <a href="#" class="kaktusp-remove-btn ${activeProductData.is_product_added ? '' : 'kaktusp-hide'}">
                                <svg class="kaktusp-product-icon" width="22px" height="20px"
                                    aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash-alt"
                                    role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                    <path fill="currentColor"
                                        d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z">
                                    </path>
                                </svg>

                                <span class="kaktusp-remove-btn-text">${activeProductData.remove_text}</span>
                            </a>
                        </div>
                    `;}
const description=product.description_html?`<div class="kaktusp-product-det__description">${product.description_html}</div>`:`<p class="kaktusp-product-det__description">${product.description}</p>`;const html=`
                    <div class="kaktusp-product-det__wrap">
                        <div class="kaktusp-product-det__body">
                            <div class="kaktusp-product-det__close">
                                <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" width="20" height="20"
                                    class="svg-inline--fa fa-times fa-kaktusp-11" role="img" xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 352 512">
                                    <path fill="currentColor"
                                        d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z">
                                    </path>
                                </svg>
                            </div>

                            <div class="kaktusp-product-det__images">
                                ${productImg}
                            </div>
                            <div class="kaktusp-product-det__content">
                                <h2 class="kaktusp-product-det__title">${product.title}</h2>

                                <div class="kaktusp-product-det__price">
                                    ${comparePrice}
                                    <span class="kaktusp-product-det__price-main">${productPrice}</span>
                                </div>

                                ${description}

                                <div class="kaktusp-product-det__variations">
                                    ${variantsHtml}
                                </div>

                                <div class="kaktusp-product-det__bottom">
                                    ${qtyHtml}
                                    ${buttonsHtml}
                                </div>
                            </div>
                        </div>
                    </div>
                `;const element=document.createElement("div");element.classList.add("kaktusp-product-det__modal");element.innerHTML=html;return element;}
init(){this.closeButton.addEventListener('click',this.hide.bind(this));if(this.qtyInput){const activeProductInput=this.activeProduct.querySelector('.kaktusp-qty-input');this.qtyPlusBtn.addEventListener('click',e=>{e.preventDefault();changeQtyValue(this.qtyInput,'add',this.maxQty);changeQtyValue(activeProductInput,'add',this.maxQty);});this.qtyMinusBtn.addEventListener('click',e=>{e.preventDefault();changeQtyValue(this.qtyInput,'sub',this.maxQty);changeQtyValue(activeProductInput,'sub',this.maxQty);});this.qtyInput.addEventListener('change',e=>{e.preventDefault();changeQtyValue(this.qtyInput,'change',this.maxQty);changeQtyValue(activeProductInput,'change',this.maxQty);});}
if(this.variationSelect){let _this=this;this.variationSelect.addEventListener("change",function(e){e.preventDefault();const activeOption=this.selectedOptions[0];const element=this.closest('.kaktusp-product-det__body');if(_this.addToCartBtn){_this.addToCartBtn.setAttribute('data-productId',this.value);}
_this.changeVariant(element,activeOption);const activeProductVariationSelect=_this.activeProduct.querySelector('.kaktusp-variations');activeProductVariationSelect.value=this.value;if("createEvent"in document){let evt=document.createEvent("HTMLEvents");evt.initEvent("change",false,true);activeProductVariationSelect.dispatchEvent(evt);}
else{activeProductVariationSelect.fireEvent("onchange");}});}
if(this.sliderPrevBtn&&this.sliderNextBtn){this.sliderPrevBtn.addEventListener('click',this.changeSlider.bind(this,'prev'));this.sliderNextBtn.addEventListener('click',this.changeSlider.bind(this,'next'));}
if(this.addToCartBtn){this.addToCartBtn.addEventListener('click',e=>{e.preventDefault();this.addProduct();});}
if(this.removeBtn){this.removeBtn.addEventListener('click',e=>{e.preventDefault();this.removeProduct();});}
return this;}
show(){this.body.append(this.template);}
hide(){restartTimer(this.rootId,this.countDownTimer);this.template.remove();}
changeActiveImg(elements,activeElement){elements.forEach(element=>element.classList.remove('kaktusp-slide-active'));activeElement.classList.add('kaktusp-slide-active');}
changeVariant(element,activeOption){const comparePriceContainer=element.querySelector(".kaktusp-product-det__price-compare");const mainPriceContainer=element.querySelector(".kaktusp-product-det__price-main");const price=activeOption.getAttribute('data-price');const variantId=activeOption.getAttribute('data-variant-id');let newPrice=price;if(comparePriceContainer){const discountValue=comparePriceContainer.getAttribute("data-discount");const discountType=comparePriceContainer.getAttribute("data-discountType");if(discountType==="%"){newPrice=(+price-(+price*+discountValue / 100)).toFixed(2);}else{newPrice=(+price- +discountValue).toFixed(2);}
comparePriceContainer.innerText=currencyFormat(price);}
mainPriceContainer.innerText=currencyFormat(newPrice)
let sliderItems=element.querySelectorAll('.kaktusp-product-det__slider-item');if(sliderItems){sliderItems.forEach(item=>{const imageIds=item.getAttribute('data-image-id').split(',');if(imageIds.includes(variantId)){this.changeActiveImg(sliderItems,item);}})}
const inCart=activeOption.getAttribute('data-added');if(inCart&&inCart==='true'){if(this.addToCartBtn&&this.removeBtn){this.addToCartBtn.classList.add('kaktusp-hide');this.removeBtn.classList.remove('kaktusp-hide');}}else{if(this.addToCartBtn&&this.removeBtn){this.addToCartBtn.classList.remove('kaktusp-hide');this.removeBtn.classList.add('kaktusp-hide');}}}
changeSlider(type){let sliderItems=document.querySelectorAll('.kaktusp-product-det__slider-item');let activeSlide;let activeSlideNumber;sliderItems.forEach((item,i)=>{if(item.classList.contains('kaktusp-slide-active')){activeSlide=item;activeSlideNumber=i;}});activeSlide.classList.remove('kaktusp-slide-active');let newActiveSlide=activeSlide;for(let i=0;i<sliderItems.length;i++){switch(type){case'next':{newActiveSlide=activeSlideNumber+1;if(newActiveSlide>=sliderItems.length){newActiveSlide=0;}
break}
case'prev':{newActiveSlide=activeSlideNumber-1;if(newActiveSlide<0){newActiveSlide=sliderItems.length-1;}
break}}
if(newActiveSlide===i){sliderItems[i].classList.add('kaktusp-slide-active');}}}
addProduct(){this.addToCartBtn.classList.add('kaktusp-preload');const activeProductAddBtn=this.activeProduct.querySelector('.kaktusp-cart-btn');activeProductAddBtn.click();setTimeout(()=>{this.addToCartBtn.classList.remove('kaktusp-preload');this.addToCartBtn.classList.add('kaktusp-hide');this.removeBtn.classList.remove('kaktusp-hide');setTimeout(()=>{restartTimer(this.rootId,this.countDownTimer);this.template.remove();},1000);},1000);}
removeProduct(){const variantId=this.addToCartBtn.getAttribute('data-productid');this.removeBtn.classList.add('kaktusp-preload');const activeProductRemoveBtn=this.activeProduct.querySelector('.kaktusp-remove-btn');activeProductRemoveBtn.click();setTimeout(()=>{this.removeBtn.classList.remove('kaktusp-preload');this.removeBtn.classList.add('kaktusp-hide');this.addToCartBtn.classList.remove('kaktusp-hide');if(this.variationSelect){this.setVariantAddedToCart(variantId,false);}},1000);}
setVariantAddedToCart(variantId,param){const varianOptions=this.variationSelect.querySelectorAll('option');varianOptions.forEach(option=>{const optionValue=parseInt(option.value);if(parseInt(variantId)===optionValue){option.setAttribute('data-added',param);}});}}
function previewProductEvents(element,product,rootId,countDownTimer,offerObj){const previewOpenerImg=element.querySelector('.kaktusp-product__img');const previewOpenerTitle=element.querySelector('.kaktusp-prod-title');previewOpenerTitle.addEventListener("click",function(e){e.preventDefault();let detailModal=new ProductPreview(product,element,rootId,countDownTimer,offerObj);detailModal.show();countDownTimer.stopTimer()});previewOpenerImg.addEventListener("click",function(e){e.preventDefault();let detailModal=new ProductPreview(product,element,rootId,countDownTimer,offerObj);detailModal.show();countDownTimer.stopTimer()});}
function removeShopifyForm(){const inventory=document.getElementById('variant-inventory');if(inventory){if(kaktuspFreeActiveApp==1&&!(inventory.textContent&&inventory.textContent.trim())){if(kaktuspRemoveButtonSelector){const remove_class=document.querySelectorAll(kaktuspRemoveButtonSelector);remove_class.forEach(node=>node.remove());}else{const forms=document.querySelectorAll('.product-form__buttons');const input=document.querySelectorAll('.prod__dynamic_checkout');const add_cart=document.querySelectorAll('.add-to-cart');const item=document.querySelectorAll('.product-form__item--payment-button');forms.forEach(node=>node.remove());input.forEach(node=>node.remove());add_cart.forEach(node=>node.remove());item.forEach(node=>node.remove());}}}}};kaktuspApp();}